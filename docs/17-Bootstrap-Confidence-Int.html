<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Statistical Methods: Exploring the Uncertain - 5.2: Bootstrap Confidence Intervals</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./18-Bootstrap-Other-Stats.html" rel="next">
<link href="./16-Bootstrap-Dist.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./16-Bootstrap-Dist.html">Chapter 5: Interval Estimates</a></li><li class="breadcrumb-item"><a href="./17-Bootstrap-Confidence-Int.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">5.2: Bootstrap Confidence Intervals</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistical Methods: Exploring the Uncertain</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Chapter 1: Exploring Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-Intro-to-Inference.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">1.1: Introduction to Statistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-EDA-Categorical.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">1.2: Exploring Categorical Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-EDA-Quantitative.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">1.3: Exploring Quantitative Data</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Chapter 2: Probability Essentials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-Overview-of-Probability.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2.1: An Overview of Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-Intro-to-Random-Variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2.2: Introduction to Random Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-Expected-Value-and-Variance.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2.3: Expected Value and Variance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-Common-Discrete-RandVar.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2.4: Common Discrete Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-Common-Continuous-Distributions.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2.5: Common Continuous Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-Joint-Distributions.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">2.6: Joint Distributions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Chapter 3: Sampling Distributions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-Sampling-Dist-Mean.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3.1: Sampling Distribution of Means</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-Sampling-Dist-Prop.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3.2: Sampling Distributions for Proportions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-Sampling-Dist-Other.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3.3: Sampling Distributions of Other Statistics</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Chapter 4: Estimation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-Estimation-MLE.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">4.1: Maximum Likelihood Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-Estimation-MOM.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">4.2: Method of Moments Estimates</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-Properties-Estimators.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">4.3: Properties of Estimators</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Chapter 5: Interval Estimates</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-Bootstrap-Dist.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">5.1: Bootstrap Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-Bootstrap-Confidence-Int.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">5.2: Bootstrap Confidence Intervals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-Bootstrap-Other-Stats.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">5.3: Bootstrapping Comparitive Statistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-Parametric-CI-Means.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">5.4: Parametric Confidence Intervals for Means</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-Parametric-CI-Proportions.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">5.5: Parametric Confidence Intervals for Proportions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Chapter 6: Hypothesis Tests</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-Intro-Hypothesis-Tests.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">6.1: Introduction to Hypothesis Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-Permutation-Tests.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">6.2: Permutation Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-Hypothesis-Single-Population.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">6.3: Parametric Hypothesis Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-Hypothesis-Comparing-Two.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">6.4: Parametric Tests for Two Populations</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Installing-R-and-RStudio.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Installing R and RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Intro-to-Vectors-Dataframes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Fundamentals of Working with Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Overview-of-Plots.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">An Overview of Plotting Data in R</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#case-study-ozone-concentration-in-new-york-city" id="toc-case-study-ozone-concentration-in-new-york-city" class="nav-link active" data-scroll-target="#case-study-ozone-concentration-in-new-york-city">Case Study: Ozone Concentration in New York City</a>
  <ul class="collapse">
  <li><a href="#sec-ozone" id="toc-sec-ozone" class="nav-link" data-scroll-target="#sec-ozone">Loading NYC Ozone Data</a>
  <ul class="collapse">
  <li><a href="#summarizing-and-storing-the-data" id="toc-summarizing-and-storing-the-data" class="nav-link" data-scroll-target="#summarizing-and-storing-the-data">Summarizing and Storing the Data</a></li>
  </ul></li>
  <li><a href="#question-1" id="toc-question-1" class="nav-link" data-scroll-target="#question-1">Question 1</a>
  <ul class="collapse">
  <li><a href="#question-1a" id="toc-question-1a" class="nav-link" data-scroll-target="#question-1a">Question 1a</a></li>
  <li><a href="#question-1b" id="toc-question-1b" class="nav-link" data-scroll-target="#question-1b">Question 1b</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#sec-bootprop" id="toc-sec-bootprop" class="nav-link" data-scroll-target="#sec-bootprop">Bootstrap Distribution for a Proportion</a>
  <ul class="collapse">
  <li><a href="#question-2" id="toc-question-2" class="nav-link" data-scroll-target="#question-2">Question 2</a>
  <ul class="collapse">
  <li><a href="#question-2a" id="toc-question-2a" class="nav-link" data-scroll-target="#question-2a">Question 2a</a></li>
  <li><a href="#question-2b" id="toc-question-2b" class="nav-link" data-scroll-target="#question-2b">Question 2b</a></li>
  <li><a href="#question-2c" id="toc-question-2c" class="nav-link" data-scroll-target="#question-2c">Question 2c</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#comparing-bootstrapping-to-clt" id="toc-comparing-bootstrapping-to-clt" class="nav-link" data-scroll-target="#comparing-bootstrapping-to-clt">Comparing Bootstrapping to CLT</a></li>
  <li><a href="#sec-fishing" id="toc-sec-fishing" class="nav-link" data-scroll-target="#sec-fishing">Point and Interval Estimates</a></li>
  <li><a href="#a-95-bootstrap-percentile-confidence-interval" id="toc-a-95-bootstrap-percentile-confidence-interval" class="nav-link" data-scroll-target="#a-95-bootstrap-percentile-confidence-interval">A 95% Bootstrap Percentile Confidence Interval</a>
  <ul class="collapse">
  <li><a href="#question-3" id="toc-question-3" class="nav-link" data-scroll-target="#question-3">Question 3</a>
  <ul class="collapse">
  <li><a href="#question-3a" id="toc-question-3a" class="nav-link" data-scroll-target="#question-3a">Question 3a</a></li>
  <li><a href="#question-3b" id="toc-question-3b" class="nav-link" data-scroll-target="#question-3b">Question 3b</a></li>
  <li><a href="#question-3c" id="toc-question-3c" class="nav-link" data-scroll-target="#question-3c">Question 3c</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#adjusting-the-confidence-level" id="toc-adjusting-the-confidence-level" class="nav-link" data-scroll-target="#adjusting-the-confidence-level">Adjusting the Confidence Level</a>
  <ul class="collapse">
  <li><a href="#question-4" id="toc-question-4" class="nav-link" data-scroll-target="#question-4">Question 4</a>
  <ul class="collapse">
  <li><a href="#question-4a" id="toc-question-4a" class="nav-link" data-scroll-target="#question-4a">Question 4a</a></li>
  <li><a href="#question-4b" id="toc-question-4b" class="nav-link" data-scroll-target="#question-4b">Question 4b</a></li>
  <li><a href="#question-4c" id="toc-question-4c" class="nav-link" data-scroll-target="#question-4c">Question 4c</a></li>
  <li><a href="#question-4d" id="toc-question-4d" class="nav-link" data-scroll-target="#question-4d">Question 4d</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#sec-indpop" id="toc-sec-indpop" class="nav-link" data-scroll-target="#sec-indpop">Comparing Two Independent Populations</a>
  <ul class="collapse">
  <li><a href="#question-5" id="toc-question-5" class="nav-link" data-scroll-target="#question-5">Question 5</a>
  <ul class="collapse">
  <li><a href="#solution-to-question-5" id="toc-solution-to-question-5" class="nav-link" data-scroll-target="#solution-to-question-5">Solution to Question 5</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#sec-smoking" id="toc-sec-smoking" class="nav-link" data-scroll-target="#sec-smoking">Case Study: Smoking and Birth Weights</a>
  <ul class="collapse">
  <li><a href="#loading-the-birth-weight-sample" id="toc-loading-the-birth-weight-sample" class="nav-link" data-scroll-target="#loading-the-birth-weight-sample">Loading the Birth Weight Sample</a></li>
  <li><a href="#question-6" id="toc-question-6" class="nav-link" data-scroll-target="#question-6">Question 6</a>
  <ul class="collapse">
  <li><a href="#solution-to-question-6" id="toc-solution-to-question-6" class="nav-link" data-scroll-target="#solution-to-question-6">Solution to Question 6</a></li>
  </ul></li>
  <li><a href="#cleaning-the-birth-weight-data" id="toc-cleaning-the-birth-weight-data" class="nav-link" data-scroll-target="#cleaning-the-birth-weight-data">Cleaning the Birth Weight Data</a></li>
  <li><a href="#question-7" id="toc-question-7" class="nav-link" data-scroll-target="#question-7">Question 7</a></li>
  <li><a href="#difference-in-two-independent-means" id="toc-difference-in-two-independent-means" class="nav-link" data-scroll-target="#difference-in-two-independent-means">Difference in Two Independent Means</a></li>
  <li><a href="#subsetting-into-two-independent-samples" id="toc-subsetting-into-two-independent-samples" class="nav-link" data-scroll-target="#subsetting-into-two-independent-samples">Subsetting Into Two Independent Samples</a></li>
  <li><a href="#question-8" id="toc-question-8" class="nav-link" data-scroll-target="#question-8">Question 8</a>
  <ul class="collapse">
  <li><a href="#question-8a" id="toc-question-8a" class="nav-link" data-scroll-target="#question-8a">Question 8a</a></li>
  <li><a href="#question-8b" id="toc-question-8b" class="nav-link" data-scroll-target="#question-8b">Question 8b</a></li>
  <li><a href="#question-8c" id="toc-question-8c" class="nav-link" data-scroll-target="#question-8c">Question 8c</a></li>
  <li><a href="#question-8d" id="toc-question-8d" class="nav-link" data-scroll-target="#question-8d">Question 8d</a></li>
  </ul></li>
  <li><a href="#accounting-for-uncertainty-in-sampling" id="toc-accounting-for-uncertainty-in-sampling" class="nav-link" data-scroll-target="#accounting-for-uncertainty-in-sampling">Accounting for Uncertainty in Sampling</a></li>
  </ul></li>
  <li><a href="#sec-bootdiffmean" id="toc-sec-bootdiffmean" class="nav-link" data-scroll-target="#sec-bootdiffmean">Bootstrapping Two Independent Samples</a>
  <ul class="collapse">
  <li><a href="#question-9" id="toc-question-9" class="nav-link" data-scroll-target="#question-9">Question 9</a>
  <ul class="collapse">
  <li><a href="#question-9a" id="toc-question-9a" class="nav-link" data-scroll-target="#question-9a">Question 9a</a></li>
  <li><a href="#question-9b" id="toc-question-9b" class="nav-link" data-scroll-target="#question-9b">Question 9b</a></li>
  <li><a href="#sec-interpret" id="toc-sec-interpret" class="nav-link" data-scroll-target="#sec-interpret">Question 9c</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">5.2: Bootstrap Confidence Intervals</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><a href="https://githubtocolab.com/CU-Denver-MathStats-OER/Statistical-Theory/blob/main/Chap5/17-Bootstrap-Confidence-Int.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" class="img-fluid" alt="Open In Colab"></a> <nbsp></nbsp></p>
<p>In our <a href="./16-Bootstrap-Dist.html">work with bootstrap distributions</a>, we explored how we can use data from one random sample that is picked from a population with unknown parameters to construct an approximation for a sampling distribution. From a bootstrap distribution, we can define a new estimator:</p>
<ul>
<li>We defined the <span style="color:dodgerblue">bootstrap estimator, <span class="math inline">\(\hat{\theta}_{\rm{boot}}\)</span></span>, as the mean (expected) value of the bootstrap distribution.</li>
<li>We use the <span style="color:dodgerblue">bootstrap standard error, <span class="math inline">\(\mbox{SE}_{\rm{boot}}\)</span>,</span> to estimate the variability in sample statistics.</li>
<li>In the case of estimating a population mean <span class="math inline">\(\mu\)</span> with a bootstrap estimator, we defined the <span style="color:dodgerblue">bootstrap estimate of bias</span> as</li>
</ul>
<p><span class="math display">\[{\color{dodgerblue}{\mbox{Bias}_{\rm{boot}} \big( \hat{\mu}_{\rm{boot}} \big) = \hat{\mu}_{\rm{boot}} - \bar{x}}}.\]</span></p>
<p>In this section we will bootstrap a sample proportion and a difference of two means. Then we use bootstrap distributions to account for the uncertainty that we build into our estimates using intervals.</p>
<section id="case-study-ozone-concentration-in-new-york-city" class="level1">
<h1>Case Study: Ozone Concentration in New York City</h1>
<hr>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="https://www-f.nescaum.org/documents/listos/AQI_Map_170518.png" class="img-fluid figure-img" style="width:65.0%" alt="Map of Air Quality in Northeastern US"></p>
<figcaption class="figure-caption">Credit: <a href="https://www-f.nescaum.org/documents/listos">Northeast States for Coordinated Air Use Management (NESCAUM)</a></figcaption>
</figure>
</div>
<p>According to the Unites States Environmental Protection Agency (EPA)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.:</p>
<blockquote class="blockquote">
<p>Ozone (O3) is a highly reactive gas composed of three oxygen atoms. It is both a natural and a man-made product that occurs in the Earth’s upper atmosphere (the stratosphere) and lower atmosphere (the troposphere). Depending on where it is in the atmosphere, ozone affects life on Earth in either good or bad ways.</p>
</blockquote>
<p>When the ozone concentration is high, respiratory illnesses such as asthma, pneumonia, and bronchitis can become exacerbated. While the effects of short-term exposure to high ozone concentration are reversible, long-term exposure may not be reversible. The EPA sets <a href="https://www.epa.gov/naaqs/ozone-o3-air-quality-standards">Ozone National Ambient Air Quality Standards (NAAQS)</a>. The existing primary and secondary standards, established in 2015 are 70 parts per billion (ppb).</p>
<p>We will begin today’s work with bootstrap distributions by investigating the following question:</p>
<blockquote class="blockquote">
<p><span style="color:dodgerblue">Is the population of New York City experiencing long-term exposure to unhealthy levels of ozone?</span></p>
</blockquote>
<section id="sec-ozone" class="level2">
<h2 class="anchored" data-anchor-id="sec-ozone">Loading NYC Ozone Data</h2>
<hr>
<p>It is likely you do not have the package <code>lattice</code> installed. You will need to first install the <code>lattice</code> package.</p>
<ul>
<li>Go to the R console window.</li>
<li>Run the command <code>install.packages("lattice")</code>.</li>
</ul>
<p>You will only need to run the <code>install.package()</code> command one time. You can now access <code>lattice</code> anytime you like! However, you will need to run the command <code>library(lattice)</code> during any R session in which you want to access data from the <code>lattice</code> package. <strong>Be sure you have first installed the <code>lattice</code> package before executing the code cell below.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># be sure you have already installed the lattice package</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)  <span class="co"># loading lattice package</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="summarizing-and-storing-the-data" class="level3">
<h3 class="anchored" data-anchor-id="summarizing-and-storing-the-data">Summarizing and Storing the Data</h3>
<hr>
<p>In the code cell below we summarize a data frame<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> named <code>environmental</code> from the <code>lattice</code> package and store the ozone concentration data <code>environmental$ozone</code> to a vector named <code>nyc.oz</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(environmental)  <span class="co"># numerical summary of each variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     ozone         radiation      temperature         wind       
 Min.   :  1.0   Min.   :  7.0   Min.   :57.00   Min.   : 2.300  
 1st Qu.: 18.0   1st Qu.:113.5   1st Qu.:71.00   1st Qu.: 7.400  
 Median : 31.0   Median :207.0   Median :79.00   Median : 9.700  
 Mean   : 42.1   Mean   :184.8   Mean   :77.79   Mean   : 9.939  
 3rd Qu.: 62.0   3rd Qu.:255.5   3rd Qu.:84.50   3rd Qu.:11.500  
 Max.   :168.0   Max.   :334.0   Max.   :97.00   Max.   :20.700  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>nyc.oz <span class="ot">&lt;-</span> environmental<span class="sc">$</span>ozone  <span class="co"># store ozone data to a vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="question-1" class="level2">
<h2 class="anchored" data-anchor-id="question-1">Question 1</h2>
<hr>
<p>We will use the sample data stored in <code>nyc.oz</code> to construct a bootstrap distribution that we can use to make predictions about the ozone concentration for the population of all times in New York City. Answer the questions below to get acquainted with the sample data.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Open the help manual in a side panel with the command <code>?environmental</code> for more details about the data.</p>
</div>
</div>
<section id="question-1a" class="level3">
<h3 class="anchored" data-anchor-id="question-1a">Question 1a</h3>
<hr>
<p>How many observations are in the sample stored in <code>nyc.oz</code>? Describe the shape of the data in <code>nyc.oz</code>.</p>
<section id="solution-to-question-1a" class="level4">
<h4 class="anchored" data-anchor-id="solution-to-question-1a">Solution to Question 1a</h4>
<hr>
<p><br><br>
<br><br>
<br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a plot to summarize shape of data in sample</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="question-1b" class="level3">
<h3 class="anchored" data-anchor-id="question-1b">Question 1b</h3>
<hr>
<p>Based on the sample data in <code>nyc.oz</code>, give an estimate for <span class="math inline">\(\m\)</span>, the mean ozone concentration in New York City (over all days and times).</p>
<section id="solution-to-question-1b" class="level4">
<h4 class="anchored" data-anchor-id="solution-to-question-1b">Solution to Question 1b</h4>
<hr>
<p><br><br>
<br><br>
<br></p>
</section>
</section>
</section>
</section>
<section id="sec-bootprop" class="level1">
<h1>Bootstrap Distribution for a Proportion</h1>
<hr>
<p>The sample mean for ozone concentration is below the 70 ppb limit. However, from the plot in <a href="#question-1a">Question 1a</a>, we see there are number of observations in the sample with an ozone concentration over 70 ppb.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count the number of observations with ozone &gt; 70 ppb</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(nyc.oz <span class="sc">&gt;</span> <span class="dv">70</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><span style="color:dodgerblue">What <strong>proportion of all time</strong> in NYC is the ozone concentration greater than 70 ppb?</span></p>
</blockquote>
<p>The sample proportion of observations with an ozone concentration greater than 70 ppb is <span class="math inline">\(\hat{p} = 24/111 \approx 0.2162\)</span>.</p>
<p>We calculate the sample proportion in two different ways below. In both methods, we use the logical test <code>nyc.oz &gt; 70</code> to help count the number of observations greater than 70 ppb, and then use:</p>
<ol type="1">
<li>A <code>sum()</code> command and divide by the sample size <code>n</code>.</li>
<li>A <code>mean()</code> command that both sums and divides by <span class="math inline">\(n\)</span>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># method 1 for computing a sample proportion</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(nyc.oz)  <span class="co"># number of observations in sample</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(nyc.oz <span class="sc">&gt;</span> <span class="dv">70</span>) <span class="sc">/</span> n  <span class="co"># sample proportion over 70 ppb</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2162162</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># method 2 for computing a sample proportion</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(nyc.oz <span class="sc">&gt;</span> <span class="dv">70</span>)  <span class="co"># sample proportion over 70 ppb</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2162162</code></pre>
</div>
</div>
<p>Both methods are equivalent and we see that</p>
<p><span class="math display">\[\hat{p} = 0.2162 = 21.62 \%.\]</span></p>
<p>Using the <a href="./16-Bootstrap-Dist.html#sec-plugin">plug-in principle</a>, a reasonable estimate for the proportion of all time that the ozone concentration in NYC is over 70 ppb (we denote the population proportion <span class="math inline">\(p\)</span>) is</p>
<p><span class="math display">\[ p \approx \hat{p} = 0.2612.\]</span></p>
<p><strong>How certain can we be in this estimate?</strong> Most likely, the sample proportion is not equal to the <em>exact</em> value of the population proportion <span class="math inline">\(p\)</span>, but it should be “close”. How close should we expect the sample proportion to be to the actual value of <span class="math inline">\(p\)</span>?</p>
<section id="question-2" class="level2">
<h2 class="anchored" data-anchor-id="question-2">Question 2</h2>
<hr>
<p>Answer each part below to construct a bootstrap distribution for the sample proportion. Then use the result to answer the questions that follow.</p>
<section id="question-2a" class="level3">
<h3 class="anchored" data-anchor-id="question-2a">Question 2a</h3>
<hr>
<p>Complete the code cell below to construct a bootstrap distribution for the sample proportion of observations with ozone concentration greater than 70 ppb.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>There are two operations to complete inside the for loop:</p>
<ol type="1">
<li>Pick a bootstrap resample from the observed sample <code>nyc.oz</code>.</li>
<li>Calculate the proportion of observations in the bootstrap resample with ozone concentration greater than 70 ppb.</li>
</ol>
</div>
</div>
<section id="solution-to-question-2a" class="level4">
<h4 class="anchored" data-anchor-id="solution-to-question-2a">Solution to Question 2a</h4>
<hr>
<p>Replace all six <code>??</code> in the code cell below with appropriate code. Then run the completed code to generate a bootstrap distribution and mark the observed sample proportion (in red) and the mean of the bootstrap distribution (in blue) with vertical lines.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>  <span class="co"># Number of bootstrap samples</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>boot.prop <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)  <span class="co"># create vector to store bootstrap proportions</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># for loop that creates bootstrap dist</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sample</span>(??, <span class="at">size =</span> ??, <span class="at">replace =</span> ??)  <span class="co"># pick a bootstrap resample</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  boot.prop[i] <span class="ot">&lt;-</span> ??  <span class="co"># compute bootstrap sample proportion</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plot bootstrap distribution</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(boot.prop,  </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks=</span><span class="dv">20</span>, </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"p-hat, sample proportion"</span>,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Bootstrap Distribution for Sample Proportion"</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co"># red line at the observed sample proportion</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ??, <span class="at">col =</span> <span class="st">"firebrick2"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co"># blue line at the center of bootstrap dist</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ??, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="question-2b" class="level3">
<h3 class="anchored" data-anchor-id="question-2b">Question 2b</h3>
<hr>
<p>Based on your answer to <a href="#question-2a">Question 2a</a>, calculate <a href="./16-Bootstrap-Dist.html#sec-bias">bootstrap estimate for bias</a>. <em>Note that answers will vary due to the randomness of bootstrapping in <a href="#question-2a">Question 2a</a>.</em></p>
<section id="solution-to-question-2b" class="level4">
<h4 class="anchored" data-anchor-id="solution-to-question-2b">Solution to Question 2b</h4>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate bootstrap estimate of bias</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br><br>
<br></p>
</section>
</section>
<section id="question-2c" class="level3">
<h3 class="anchored" data-anchor-id="question-2c">Question 2c</h3>
<hr>
<p>Based on your answer to <a href="#question-2a">Question 2a</a>, calculate the bootstrap estimate for the standard error of the sampling distribution for sample proportions. <em>Note that answers will vary due to the randomness of bootstrapping in <a href="#question-2a">Question 2a</a>.</em></p>
<section id="solution-to-question-2c" class="level4">
<h4 class="anchored" data-anchor-id="solution-to-question-2c">Solution to Question 2c</h4>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate bootstrap standard error</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br><br>
<br></p>
</section>
</section>
</section>
</section>
<section id="comparing-bootstrapping-to-clt" class="level1">
<h1>Comparing Bootstrapping to CLT</h1>
<hr>
<p>Recall the <a href="./11-Sampling-Dist-Prop.html">Central Limit Theorem (CLT) for Proportions</a>,</p>
<p><span class="math display">\[\widehat{P} \sim N \left( \mu_{\hat{P}}, \mbox{SE}(\widehat{P}) \right) = \left( {\color{tomato}{p}}, \sqrt{\frac{{\color{tomato}{p}}(1-{\color{tomato}{p}})}{n}} \right).\]</span></p>
<p>The population proportion <span class="math inline">\(p\)</span> is unknown, but we can use the <a href="./16-Bootstrap-Dist.html#sec-plugin">plug-in principle</a> and “plug-in” the sample proportion <span class="math inline">\({\color{tomato}{\hat{p} = 0.2162}}\)</span> in place of <span class="math inline">\(p\)</span> to estimate the sampling distribution for the sample proportion:</p>
<p><span class="math display">\[\begin{aligned}
\widehat{P} \sim N \left( \mu_{\hat{P}}, \mbox{SE}(\widehat{P}) \right) &amp;= \left( {\color{tomato}{p}}, \sqrt{\frac{{\color{tomato}{p}}(1-{\color{tomato}{p}})}{n}} \right) \\
\widehat{P} &amp; \approx N\left( {\color{tomato}{0.2162}}, \sqrt{\frac{{\color{tomato}{0.2162}}(1-{\color{tomato}{0.2162}})}{111}} \right) \\
\widehat{P} &amp; \approx N( 0.2162, 0.0391).
\end{aligned}\]</span></p>
<table class="table">
<colgroup>
<col style="width: 44%">
<col style="width: 36%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>Mean of Sampling Distribution</th>
<th>Standard Error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bootstrap<sup>*</sup></td>
<td><span class="math inline">\(0.2164\)</span></td>
<td><span class="math inline">\(0.0390\)</span></td>
</tr>
<tr class="even">
<td>CLT with <span class="math inline">\(\hat{p}\)</span> in place of <span class="math inline">\(p\)</span></td>
<td><span class="math inline">\(0.2162\)</span></td>
<td><span class="math inline">\(0.0391\)</span></td>
</tr>
</tbody>
</table>
<p><span style="font-size:80%">* Bootstrap estimates from <a href="#question-2">Question 2</a> will slightly vary.</span></p>
<p><br></p>
<p>The two methods, bootstrap distribution and the estimate from using the CLT, give us consistent results!</p>
</section>
<section id="sec-fishing" class="level1">
<h1>Point and Interval Estimates</h1>
<hr>
<p>Estimators obtained using maximum likelihood estimates (MLE), method of moments (MoM), or plug-in principle are examples of <span style="color:tomato"><strong>point estimates</strong></span> since they result in a <span style="color:tomato"><strong>single value</strong></span> to estimate the unknown population parameter.</p>
<ul>
<li>For example, using the plug-in principle, we have a point estimate <span class="math inline">\({\color{tomato}{p \approx \hat{p} = 0.2162}}\)</span>.</li>
<li>Since there is variability from sample to sample, it is not very likely that our point estimate is perfectly accurate, but it is likely close.</li>
<li>We get a very specific estimate that is unlikely to be exactly equal to the actual parameter value.</li>
<li><span style="color:tomato"><strong>Point estimates are like trying to catch a fish with a spear.</strong></span></li>
</ul>
<p>Usually when estimating an unknown population parameter, we give an <span style="color:dodgerblue"><strong>interval estimate</strong></span> that gives a <span style="color:dodgerblue"><strong>range of plausible values</strong></span> for the parameter by accounting for the uncertainty due to the variability in sampling.</p>
<ul>
<li>Using both the mean and standard error from the bootstrap distribution in <a href="#question-2c">Question 2c</a>, one possible interval estimate is <span class="math display">\[p \approx \hat{p}_{\rm boot} \pm \mbox{SE}_{\rm boot}  = 0.216 \pm 0.039.\]</span>
<ul>
<li><span style="color:dodgerblue">An interval of plausible values for <span class="math inline">\(p\)</span> is from <span class="math inline">\(0.177\)</span> to <span class="math inline">\(0.255\)</span></span>.<br>
</li>
</ul></li>
<li>It is more likely the actual value of the parameter is somewhere inside the interval estimate than it is to be exactly equal to a point estimate.</li>
<li>However, interval estimates are less precise.</li>
<li><span style="color:dodgerblue"><strong>Interval estimates are like trying to catch a fish with a net.</strong></span></li>
<li>We are more likely to catch a fish even if we do not know specifically where the fish is located!</li>
<li><span style="color:dodgerblue"><strong>We frequently estimate parameters with an interval to account for the variability of sample statistics.</strong></span></li>
</ul>
<div id="fig-fishing" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 47.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://i0.wp.com/pixahive.com/wp-content/uploads/2020/09/Man-Throwing-a-Fishing-Net-79117-pixahive.jpg?fit=778%2C518&amp;ssl=1" class="img-fluid figure-img" alt="Man Throwing a Fishing Net"></p>
<figcaption class="figure-caption">Credit: Rahil, <a href="https://creativecommons.org/share-your-work/public-domain/cc0/">Public Domain</a>, <a href="https://pixahive.com/photo/man-throwing-a-fishing-net/">Pixahive</a></figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 53.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://cdn2.picryl.com/photo/1898/12/31/fmib-48360-indian-sealing-canoe-showing-method-of-throwing-spear-7cbd5a-1024.jpeg" class="img-fluid figure-img" alt="Sealing Canoe Showing Method of Throwing Spear"></p>
<figcaption class="figure-caption">Credit: <a href="https://garystockbridge617.getarchive.net/amp/media/fmib-48360-indian-sealing-canoe-showing-method-of-throwing-spear-7cbd5a">Townsend, C. H</a>. (1898), Public Domain</figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;21.1: Fishing with an interval estimate compared to a point estimate.</figcaption><p></p>
</figure>
</div>
</section>
<section id="a-95-bootstrap-percentile-confidence-interval" class="level1">
<h1>A 95% Bootstrap Percentile Confidence Interval</h1>
<hr>
<p>The interval between the <span class="math inline">\(2.5\)</span> and <span class="math inline">\(97.5\)</span> percentiles (or <span class="math inline">\(0.025\)</span> and <span class="math inline">\(0.975\)</span> quantiles) of the bootstrap distribution of a statistic is a <span style="color:dodgerblue"><strong>95% bootstrap percentile confidence interval</strong></span> for the corresponding parameter.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-confint" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="17-Bootstrap-Confidence-Int_files/figure-html/fig-confint-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;22.1: Finding Cutoffs for a 95% Bootstrap Percentile Confidence Interval</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li>If most of the sample statistics are located in a certain interval of the bootstrap distribution, it seems plausible the true value of the parameter is in this interval!</li>
<li>We are 95% confident that the interval contains the actual value of the population parameter since 95% of the bootstrap resamples are inside this interval.</li>
<li><span style="color:dodgerblue"><strong>Confidence interval estimates give a range of plausible values for an unknown parameter.</strong></span></li>
</ul>
<section id="question-3" class="level2">
<h2 class="anchored" data-anchor-id="question-3">Question 3</h2>
<hr>
<p>In <a href="#question-2">Question 2</a>, we created a bootstrap distribution (stored in the vector <code>boot.prop</code>) for the sample proportion of times the ozone concentration exceeds 70 ppb. One possible bootstrap distribution is plotted below. <em>Note that bootstrap distributions will vary slightly depending on the 100,000 bootstrap resamples that are randomly selected.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot bootstrap distribution</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(boot.prop,  </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks=</span><span class="dv">20</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"p-hat, sample proportion"</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Bootstrap Distribution for Sample Proportion"</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># red line at the observed sample proportion</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(nyc.oz <span class="sc">&gt;</span> <span class="dv">70</span>), <span class="at">col =</span> <span class="st">"firebrick2"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># blue line at the center of bootstrap dist</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(boot.prop), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="17-Bootstrap-Confidence-Int_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="question-3a" class="level3">
<h3 class="anchored" data-anchor-id="question-3a">Question 3a</h3>
<hr>
<p>Using the bootstrap statistics stored in <code>boot.prop</code>, find the lower and upper cutoffs for a 95% bootstrap percentile confidence interval for the proportion of all times the ozone concentration in NYC exceeds 70 ppb.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Recall the <code>quantile()</code> function in R. Run the command <code>?quantile</code> for a refresher!</p>
</div>
</div>
<section id="solution-to-question-3a" class="level4">
<h4 class="anchored" data-anchor-id="solution-to-question-3a">Solution to Question 3a</h4>
<hr>
<p>Replace all four <code>??</code> in the code cell below with appropriate code. Then run the completed code to compute lower and upper cutoffs for a 95% bootstrap percentile confidence interval.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find cutoffs for 95% bootstrap CI</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>lower.boot<span class="fl">.95</span> <span class="ot">&lt;-</span> <span class="fu">quantile</span>(??, <span class="at">probs =</span> ??)  <span class="co"># find lower cutoff</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>upper.boot<span class="fl">.95</span> <span class="ot">&lt;-</span> <span class="fu">quantile</span>(??, <span class="at">probs =</span> ??)  <span class="co"># find upper cutoff</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print values to screen</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>lower.boot<span class="fl">.95</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>upper.boot<span class="fl">.95</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Based on the output above, a 95% bootstrap percentile confidence interval is from ?? to ??.</strong></p>
<p><br><br>
<br></p>
</section>
</section>
<section id="question-3b" class="level3">
<h3 class="anchored" data-anchor-id="question-3b">Question 3b</h3>
<hr>
<p>The code cell below plots a bootstrap distribution corresponding to the sample proportions stored in <code>boot.prop</code> along with two blue vertical lines to mark the lower and upper cutoffs for a 95% bootstrap percentile confidence interval. A red vertical line marks the value of the sample proportion we calculated from the original sample.</p>
<p>Run the code cell below to illustrate the confidence interval on the bootstrap distribution. There is nothing to edit in the code cell. Then in the space below, explain the practical meaning of the interval to a person with little to no background in statistics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">#################################</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># code is ready to run!</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># no need to edit the code cell</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="do">#################################</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot bootstrap distribution</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(boot.prop,  </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks=</span><span class="dv">20</span>, </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"p-hat, sample proportion"</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Bootstrap Distribution for Sample Proportion"</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co"># red line at the observed sample proportion</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(nyc.oz <span class="sc">&gt;</span> <span class="dv">70</span>), <span class="at">col =</span> <span class="st">"firebrick2"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co"># blue lines marking cutoffs</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> lower.boot<span class="fl">.95</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> upper.boot<span class="fl">.95</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="17-Bootstrap-Confidence-Int_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="solution-to-question-3b" class="level4">
<h4 class="anchored" data-anchor-id="solution-to-question-3b">Solution to Question 3b</h4>
<hr>
<p>Interpret the confidence interval from <a href="#question-3a">Question 3a</a>.</p>
<p><br><br>
<br><br>
<br></p>
</section>
</section>
<section id="question-3c" class="level3">
<h3 class="anchored" data-anchor-id="question-3c">Question 3c</h3>
<hr>
<p>Sometimes, it is desirable to describe the interval as some value plus or minus some margin of error.</p>
<p><span class="math display">\[\mbox{Symmetric Interval:} \qquad \mbox{point estimate} \pm \mbox{margin of error}\]</span></p>
<p>Construct a <span style="color:dodgerblue"><strong>symmetric 95% bootstrap confidence interval</strong></span> for the proportion of time the ozone concentration in NYC exceeds 70 ppb. Compare the symmetric confidence interval to your percentile confidence interval in <a href="#question-3a">Question 3a</a>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Recall for normal distributions, approximately 95% of the data is within 2 standard deviations of center of the distribution.</p>
</div>
</div>
<section id="solution-to-question-3c" class="level4">
<h4 class="anchored" data-anchor-id="solution-to-question-3c">Solution to Question 3c</h4>
<hr>
<p>Replace each <code>??</code> in the code cell below with appropriate code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>?? <span class="sc">-</span> ??  <span class="co"># going 2 SE's below the observed sample proportion</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>?? <span class="sc">+</span> ??  <span class="co"># going 2 SE's above the observed sample proportion</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Based on the output above, a symmetric 95% bootstrap confidence interval is from ?? to ??.</strong></p>
<p><br><br>
<br></p>
</section>
</section>
</section>
</section>
<section id="adjusting-the-confidence-level" class="level1">
<h1>Adjusting the Confidence Level</h1>
<hr>
<p>We would expect the actual value of the unknown population parameter to equal the corresponding statistic calculated from one of the 100,000 bootstrap resamples in our distribution. Since 95% of the bootstrap statistics are inside the confidence interval:</p>
<blockquote class="blockquote">
<p><strong>A 95% bootstrap confidence interval has about a 95% chance of containing the actual value of the population parameter.</strong></p>
</blockquote>
<p>The <span style="color:dodgerblue"><strong>confidence level</strong></span> is the <span style="color:dodgerblue"><strong>success rate</strong></span> of the interval estimate. We can choose different confidence levels for an interval estimate.</p>
<ul>
<li>A 95% confidence level is most common.</li>
<li>Other common confidence levels are 80%, 90%, 99% and 99.9%.</li>
<li>We choose a confidence level. It is not something we calculate.</li>
<li><strong>What happens to an interval estimate when we change the confidence level?</strong></li>
</ul>
<section id="question-4" class="level2">
<h2 class="anchored" data-anchor-id="question-4">Question 4</h2>
<hr>
<p>In <a href="#question-2">Question 2</a>, we created a bootstrap distribution (stored in the vector <code>boot.prop</code>) for the sample proportion of times the ozone concentration exceeds 70 ppb. In <a href="#question-3">Question 3</a>, we used the bootstrap distribution to construct a 95% bootstrap percentile confidence interval. In this question, we will investigate what happens when we change the confidence level.</p>
<section id="question-4a" class="level3">
<h3 class="anchored" data-anchor-id="question-4a">Question 4a</h3>
<hr>
<p>Complete the first code cell below to give a 90% bootstrap percentile confidence interval to estimate the proportion of all time in NYC when the ozone concentration exceeds 70 ppb.</p>
<p>Then complete the second code cell to plot a histogram of the bootstrap distribution from <a href="#question-2">Question 2</a> with the upper and lower 90% bootstrap confidence interval cutoffs marked with vertical lines similar to the plot in <a href="#question-3b">Question 3b</a>.</p>
<section id="solution-to-question-4a" class="level4">
<h4 class="anchored" data-anchor-id="solution-to-question-4a">Solution to Question 4a</h4>
<hr>
<p><strong>Based on the output below, a 90% bootstrap percentile confidence interval is from ?? to ??.</strong></p>
<p><br><br>
<br></p>
<p>Replace all four <code>??</code> in the code cell below with appropriate code. Then run the completed code to compute lower and upper cutoffs for a 90% bootstrap percentile confidence interval.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find cutoffs for 90% bootstrap CI</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>lower.prop<span class="fl">.90</span> <span class="ot">&lt;-</span> <span class="fu">quantile</span>(??, <span class="at">probs =</span> ??)  <span class="co"># find lower cutoff</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>upper.prop<span class="fl">.90</span> <span class="ot">&lt;-</span> <span class="fu">quantile</span>(??, <span class="at">probs =</span> ??)  <span class="co"># find upper cutoff</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print to screen</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>lower.prop<span class="fl">.90</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>upper.prop<span class="fl">.90</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nothing to edit in the code cell below. Just be sure you first run the code cell above to calculate and store the cutoffs <code>lower.prop.90</code> and <code>upper.prop.90</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">##################################</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># code is ready to run!</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># no need to edit the code cell</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="do">##################################</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot bootstrap distribution</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(boot.prop,  </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks=</span><span class="dv">20</span>, </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"p-hat, sample proportion"</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Bootstrap Distribution for Sample Proportion"</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co"># red line at the observed sample proportion</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(nyc.oz <span class="sc">&gt;</span> <span class="dv">70</span>), <span class="at">col =</span> <span class="st">"firebrick2"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co"># blue lines marking cutoffs</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> lower.prop<span class="fl">.90</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> upper.prop<span class="fl">.90</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="question-4b" class="level3">
<h3 class="anchored" data-anchor-id="question-4b">Question 4b</h3>
<hr>
<p>Complete the first code cell below to give a 99% bootstrap percentile confidence interval to estimate the proportion of all time in NYC when the ozone concentration exceeds 70 ppb.</p>
<p>Then complete the second code cell to plot a histogram of the bootstrap distribution from <a href="#question-2">Question 2</a> with the upper and lower 99% bootstrap confidence interval cutoffs marked with vertical lines similar to the plot in <a href="#question-3b">Question 3b</a>.</p>
<section id="solution-to-question-4b" class="level4">
<h4 class="anchored" data-anchor-id="solution-to-question-4b">Solution to Question 4b</h4>
<hr>
<p><strong>Based on the output below, a 99% bootstrap percentile confidence interval is from ?? to ??.</strong></p>
<p><br><br>
<br></p>
<p>Replace all four <code>??</code> in the code cell below with appropriate code. Then run the completed code to compute lower and upper cutoffs for a 99% bootstrap percentile confidence interval.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find cutoffs for 99% bootstrap CI</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>lower.prop<span class="fl">.99</span> <span class="ot">&lt;-</span> <span class="fu">quantile</span>(??, <span class="at">probs =</span> ??)  <span class="co"># find lower cutoff</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>upper.prop<span class="fl">.99</span> <span class="ot">&lt;-</span> <span class="fu">quantile</span>(??, <span class="at">probs =</span> ??)  <span class="co"># find upper cutoff</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print to screen</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>lower.prop<span class="fl">.99</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>upper.prop<span class="fl">.99</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nothing to edit in the code cell below. Just be sure you first run the code cell above to calculate and store the cutoffs <code>lower.prop.99</code> and <code>upper.prop.99</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">##################################</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># code is ready to run!</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># no need to edit the code cell</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="do">##################################</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot bootstrap distribution</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(boot.prop,  </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks=</span><span class="dv">20</span>, </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"p-hat, sample proportion"</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Bootstrap Distribution for Sample Proportion"</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co"># red line at the observed sample proportion</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(nyc.oz <span class="sc">&gt;</span> <span class="dv">70</span>), <span class="at">col =</span> <span class="st">"firebrick2"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co"># blue lines marking cutoffs</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> lower.prop<span class="fl">.99</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> upper.prop<span class="fl">.99</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="question-4c" class="level3">
<h3 class="anchored" data-anchor-id="question-4c">Question 4c</h3>
<hr>
<p>When we decreased the confidence level from 95% in <a href="#question-3a">Question 3a</a> to 90% in <a href="#question-4a">Question 4a</a>, did the interval estimate get wider or more narrow? Explain why this makes practical sense. Feel free to explain using the <a href="#sec-fishing">fishing analogy</a> from earlier.</p>
<section id="solution-to-question-4c" class="level4">
<h4 class="anchored" data-anchor-id="solution-to-question-4c">Solution to Question 4c</h4>
<hr>
<p><br><br>
<br><br>
<br></p>
</section>
</section>
<section id="question-4d" class="level3">
<h3 class="anchored" data-anchor-id="question-4d">Question 4d</h3>
<hr>
<p>Explain the trade-off between choosing a confidence level and the precision of the interval estimate. In particular, why choose a 95% confidence interval over an interval that has a greater chance of success, such as a 99% confidence interval?</p>
<section id="solution-to-question-4d" class="level4">
<h4 class="anchored" data-anchor-id="solution-to-question-4d">Solution to Question 4d</h4>
<hr>
<p><br><br>
<br><br>
<br></p>
</section>
</section>
</section>
</section>
<section id="sec-indpop" class="level1">
<h1>Comparing Two Independent Populations</h1>
<hr>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="https://static01.nyt.com/images/2020/01/28/well/physed-babies/physed-babies-jumbo.jpg?quality=75&amp;auto=webp" class="img-fluid figure-img" style="width:50.0%" alt="Toddlers"></p>
<figcaption class="figure-caption">Credit: iStock</figcaption>
</figure>
</div>
<p>Thus far, we have been bootstrapping from a sample that has just one variable of interest. For example, in <code>nyc.oz</code> we have <span class="math inline">\(n=111\)</span> observed ozone concentrations in NYC. For each observation in our sample, we have one variable of interest, namely the ozone concentration (in ppb). In statistics, we are often interested in determining whether there is an association between two or more different variables. For example, we can ask:</p>
<blockquote class="blockquote">
<p>Does smoking during pregnancy have an affect on the weight of the baby at birth?</p>
</blockquote>
<p>To answer this question, we can collect data from a random sample of newborn babies. However, we need to collect more than one variable for each newborn in our sample to answer the question above.</p>
<section id="question-5" class="level2">
<h2 class="anchored" data-anchor-id="question-5">Question 5</h2>
<hr>
<p>Explain how you could design a study to collect data that could help determine whether smoking during pregnancy has an affect on the weight of the baby at birth.</p>
<section id="solution-to-question-5" class="level3">
<h3 class="anchored" data-anchor-id="solution-to-question-5">Solution to Question 5</h3>
<hr>
<p><br><br>
<br><br>
<br></p>
</section>
</section>
</section>
<section id="sec-smoking" class="level1">
<h1>Case Study: Smoking and Birth Weights</h1>
<hr>
<p>To help explore this question, we will use the sample in the data frame<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> <code>birthwt</code> that is in the package <code>MASS</code> which should already be installed. In the code cell below, the <code>MASS</code> package is loaded and numerical summaries for all variables in <code>birthwt</code> are computed and displayed.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you receive an error message when running the code cell below, then you do not have the <code>MASS</code> package installed.</p>
<ul>
<li>In the R console, run the command <code>install.packages("MASS")</code>.</li>
<li>Then rerun the code cell below.</li>
</ul>
</div>
</div>
<section id="loading-the-birth-weight-sample" class="level2">
<h2 class="anchored" data-anchor-id="loading-the-birth-weight-sample">Loading the Birth Weight Sample</h2>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)  <span class="co"># load MASS package</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(birthwt)  <span class="co"># summary of data frame</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      low              age             lwt             race      
 Min.   :0.0000   Min.   :14.00   Min.   : 80.0   Min.   :1.000  
 1st Qu.:0.0000   1st Qu.:19.00   1st Qu.:110.0   1st Qu.:1.000  
 Median :0.0000   Median :23.00   Median :121.0   Median :1.000  
 Mean   :0.3122   Mean   :23.24   Mean   :129.8   Mean   :1.847  
 3rd Qu.:1.0000   3rd Qu.:26.00   3rd Qu.:140.0   3rd Qu.:3.000  
 Max.   :1.0000   Max.   :45.00   Max.   :250.0   Max.   :3.000  
     smoke             ptl               ht                ui        
 Min.   :0.0000   Min.   :0.0000   Min.   :0.00000   Min.   :0.0000  
 1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.00000   1st Qu.:0.0000  
 Median :0.0000   Median :0.0000   Median :0.00000   Median :0.0000  
 Mean   :0.3915   Mean   :0.1958   Mean   :0.06349   Mean   :0.1481  
 3rd Qu.:1.0000   3rd Qu.:0.0000   3rd Qu.:0.00000   3rd Qu.:0.0000  
 Max.   :1.0000   Max.   :3.0000   Max.   :1.00000   Max.   :1.0000  
      ftv              bwt      
 Min.   :0.0000   Min.   : 709  
 1st Qu.:0.0000   1st Qu.:2414  
 Median :0.0000   Median :2977  
 Mean   :0.7937   Mean   :2945  
 3rd Qu.:1.0000   3rd Qu.:3487  
 Max.   :6.0000   Max.   :4990  </code></pre>
</div>
</div>
</section>
<section id="question-6" class="level2">
<h2 class="anchored" data-anchor-id="question-6">Question 6</h2>
<hr>
<p>How many observations are in the data set? How many variables? Which variables are categorical and which are quantitative? Which variables are most important in helping determine whether smoking during pregnancy has an affect on the weight of the baby at birth?</p>
<section id="solution-to-question-6" class="level3">
<h3 class="anchored" data-anchor-id="solution-to-question-6">Solution to Question 6</h3>
<hr>
<p><br><br>
<br><br>
<br></p>
</section>
</section>
<section id="cleaning-the-birth-weight-data" class="level2">
<h2 class="anchored" data-anchor-id="cleaning-the-birth-weight-data">Cleaning the Birth Weight Data</h2>
<hr>
<p>The variable <code>smoke</code> is being stored as a quantitative variable.</p>
<ul>
<li>Pregnant parents that did not smoke have a <code>smoke</code> value equal to <code>0</code>.</li>
<li>Pregnant parents that were smokers have a <code>smoke</code> value equal to <code>1</code>.</li>
<li>Run the code cell below to make these categories more clearly labeled.
<ul>
<li>Non-smokers are assigned the character string <code>"no"</code>.</li>
<li>Smokers are assigned the character string <code>"smoker"</code>.</li>
<li>We use the <code>factor()</code> command to convert the <code>smoke</code> variable to a categorical variable.</li>
<li>The output tells us out of 189 parents, 115 self-identified as non-smokers and 74 as smokers.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>birthwt<span class="sc">$</span>smoke[birthwt<span class="sc">$</span>smoke <span class="sc">==</span> <span class="dv">0</span>]  <span class="ot">&lt;-</span> <span class="st">"no"</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>birthwt<span class="sc">$</span>smoke[birthwt<span class="sc">$</span>smoke <span class="sc">==</span> <span class="dv">1</span>]  <span class="ot">&lt;-</span> <span class="st">"smoker"</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>birthwt<span class="sc">$</span>smoke <span class="ot">&lt;-</span> <span class="fu">factor</span>(birthwt<span class="sc">$</span>smoke)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(birthwt<span class="sc">$</span>smoke)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    no smoker 
   115     74 </code></pre>
</div>
</div>
</section>
<section id="question-7" class="level2">
<h2 class="anchored" data-anchor-id="question-7">Question 7</h2>
<hr>
<p>Complete the code cell below to create a side-by-side box plots to compare the distribution of weights for smokers and non-smokers.</p>
<section id="solution-to-question-7" class="level4">
<h4 class="anchored" data-anchor-id="solution-to-question-7">Solution to Question 7</h4>
<hr>
<p>Replace each <code>??</code> in the code cell below to generate side-by-side box plots for comparison.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create side by side box plots</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(?? <span class="sc">~</span> ??, <span class="at">data =</span> ??,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"springgreen4"</span>, <span class="st">"firebrick2"</span>),</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Birth Weights from Smokers and Non-Smokers"</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Smoking Status of Pregnant Parent"</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Birth Weight (in grams)"</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Non-smoker"</span>, <span class="st">"Smoker"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br><br>
<br></p>
</section>
</section>
<section id="difference-in-two-independent-means" class="level2">
<h2 class="anchored" data-anchor-id="difference-in-two-independent-means">Difference in Two Independent Means</h2>
<hr>
<p>Our statistical question is:</p>
<blockquote class="blockquote">
<p>Does smoking during pregnancy have an affect on the weight of the baby at birth?</p>
</blockquote>
<p>In this example, we have two independent populations of parents to consider.</p>
<ul>
<li>All pregnant parents that did not smoke during pregnancy.</li>
<li>All pregnant parents that smoked during pregnancy.</li>
<li>A pregnant person is either in one group or the other, but not both.</li>
</ul>
<p>Ideally, if we had access to data on every baby that has ever been born, then we could:</p>
<ul>
<li>Calculate <span class="math inline">\(\mu_{\rm{non}}\)</span>, the mean birth weight of <em>all</em> children of non-smokers.</li>
<li>Calculate <span class="math inline">\(\mu_{\rm{smoker}}\)</span>, the mean birth weight of <em>all</em> children of smokers.</li>
<li>Consider how large is the difference in the two means, <span class="math inline">\(\mu_{\rm{non}} - \mu_{\rm{smoker}}\)</span>.
<ul>
<li>If the difference in populations means is 0, there is no difference in mean birth weights.</li>
<li>If the difference is not 0, then there is a difference in mean birth weights.</li>
</ul></li>
</ul>
<p>Although we have data from a random sample rather than the entire population, we can perform equivalent analysis comparing two sample means:</p>
<ul>
<li>Calculate <span class="math inline">\(\bar{x}_{\rm{non}}\)</span>, the <em>sample</em> mean birth weight of children of non-smokers in the sample.</li>
<li>Calculate <span class="math inline">\(\bar{x}_{\rm{smoker}}\)</span>, the <em>sample</em> mean birth weight of children of smokers in the sample.</li>
<li>Consider how large is the difference in the two means, <span class="math inline">\(\bar{x}_{\rm{non}} - \bar{x}_{\rm{smoker}}\)</span>.
<ul>
<li>If the difference is <em>close to zero</em>, there is likely no difference in the population means.</li>
<li>If the difference is <em>not close to zero</em>, there likely is a difference in the population means.</li>
<li>How can we determine what we mean by “close to zero”?</li>
</ul></li>
</ul>
</section>
<section id="subsetting-into-two-independent-samples" class="level2">
<h2 class="anchored" data-anchor-id="subsetting-into-two-independent-samples">Subsetting Into Two Independent Samples</h2>
<hr>
<p>At the moment, we have all of the sample data for smokers and non-smokers stored in the same data frame named <code>birthwt</code>. How can we calculate the sample mean birth weights for the non-smoking group separate from the smoking group? One way to compare the two samples is to split the sample into two independent subsets based on whether or not the child was birthed by a smoker or not.</p>
</section>
<section id="question-8" class="level2">
<h2 class="anchored" data-anchor-id="question-8">Question 8</h2>
<hr>
<p>Answer the questions to find an initial point estimate for the difference in the mean birth weights of all children born to a non-smoking parent compared to the mean birth weight of all children born to a parent that did smoke while pregnant.</p>
<section id="question-8a" class="level3">
<h3 class="anchored" data-anchor-id="question-8a">Question 8a</h3>
<hr>
<p>Complete each of the <code>subset()</code> commands below to subset the data into two independent samples: parent was a smoker and parent was a non-smoker.</p>
<section id="solution-to-question-8a" class="level4">
<h4 class="anchored" data-anchor-id="solution-to-question-8a">Solution to Question 8a</h4>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subset the sample into two independent samples</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>non <span class="ot">&lt;-</span> <span class="fu">subset</span>(??, smoke <span class="sc">==</span> ??)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>smoker <span class="ot">&lt;-</span> <span class="fu">subset</span>(??, smoke <span class="sc">==</span> ??)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br><br>
<br></p>
</section>
</section>
<section id="question-8b" class="level3">
<h3 class="anchored" data-anchor-id="question-8b">Question 8b</h3>
<hr>
<p>Complete the code cell below to calculate, store, and print the difference in sample means based on the data in our original sample.</p>
<section id="solution-to-question-8b" class="level4">
<h4 class="anchored" data-anchor-id="solution-to-question-8b">Solution to Question 8b</h4>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate difference in sample means</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>obs.diff <span class="ot">&lt;-</span> ??</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>obs.diff  <span class="co"># print observed difference to screen</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br><br>
<br></p>
</section>
</section>
<section id="question-8c" class="level3">
<h3 class="anchored" data-anchor-id="question-8c">Question 8c</h3>
<hr>
<p>Based on your answer to <a href="#question-8b">Question 8b</a>, given a <strong>point estimate</strong> for the difference in the mean birth weights of all children born to a non-smoking parent compared to the mean birth weight of all children born to a parent that did smoke while pregnant. <em>Include units in your answer.</em></p>
<section id="solution-to-question-8c" class="level4">
<h4 class="anchored" data-anchor-id="solution-to-question-8c">Solution to Question 8c</h4>
<hr>
<p><br><br>
<br><br>
<br></p>
</section>
</section>
<section id="question-8d" class="level3">
<h3 class="anchored" data-anchor-id="question-8d">Question 8d</h3>
<hr>
<p>Based on your estimate in <a href="#question-8c">Question 8c</a>, do you believe there is a difference in the mean birth weight of all babies whose parent smoked while pregnant compared to the mean birth weight of all babies whose parent did not smoke while pregnant?</p>
<section id="solution-to-question-8d" class="level4">
<h4 class="anchored" data-anchor-id="solution-to-question-8d">Solution to Question 8d</h4>
<hr>
<p><br><br>
<br><br>
<br></p>
</section>
</section>
</section>
<section id="accounting-for-uncertainty-in-sampling" class="level2">
<h2 class="anchored" data-anchor-id="accounting-for-uncertainty-in-sampling">Accounting for Uncertainty in Sampling</h2>
<hr>
<p>In the case of comparing samples, we need to be mindful of the randomness involved in the sampling process. If we pick another sample of 189 babies and compare the difference in sample means, we will likely get a different estimate for the difference in mean birth weights. <strong>How can we determine whether or not the point estimate in <a href="#question-8c">Question 8c</a> is “close enough to zero”?</strong></p>
</section>
</section>
<section id="sec-bootdiffmean" class="level1">
<h1>Bootstrapping Two Independent Samples</h1>
<hr>
<p>Given independent samples of sizes <span class="math inline">\(m\)</span> and <span class="math inline">\(n\)</span> from two independent populations:</p>
<ol type="1">
<li>Draw a bootstrap resample of size <span class="math inline">\(m\)</span> <em>with replacement</em> from the first sample.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>m.non <span class="ot">&lt;-</span> <span class="fu">length</span>(non<span class="sc">$</span>bwt)  <span class="co"># m, size of sample 1</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>temp.non <span class="ot">&lt;-</span> <span class="fu">sample</span>(non<span class="sc">$</span>bwt, <span class="at">size =</span> m.non, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Draw a bootstrap resample of size <span class="math inline">\(n\)</span> <em>with replacement</em> from the second sample.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>n.smoker <span class="ot">&lt;-</span> <span class="fu">length</span>(smoker<span class="sc">$</span>bwt)  <span class="co"># n, size of sample 2</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>temp.smoker <span class="ot">&lt;-</span> <span class="fu">sample</span>(smoker<span class="sc">$</span>bwt, <span class="at">size =</span> n.smoker, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Compute a statistic that compares the two groups such as a difference or ratio of two statistics (means, proportions, variances, etc.).</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>diff.resample <span class="ot">&lt;-</span> <span class="fu">mean</span>(temp.non) <span class="sc">-</span> <span class="fu">mean</span>(temp.smoker)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>diff.resample</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 209.3382</code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Repeat this process many (100,000) times.</li>
<li>Construct a bootstrap distribution of the comparison statistics from each resample.</li>
</ol>
<section id="question-9" class="level2">
<h2 class="anchored" data-anchor-id="question-9">Question 9</h2>
<hr>
<p>Follow the steps below to generate a bootstrap distribution for the difference in sample mean birth weights for babies born to non-smokers compared to babies born to smokers. Then use the bootstrap distribution to obtain a 95% bootstrap percentile confidence interval for the corresponding difference in population means.</p>
<section id="question-9a" class="level3">
<h3 class="anchored" data-anchor-id="question-9a">Question 9a</h3>
<hr>
<p>Complete the code cell below to construct a bootstrap distribution for the difference in the sample mean birth weights of of babies born to non-smokers compared to smokers.</p>
<section id="solution-to-question-9a" class="level4">
<h4 class="anchored" data-anchor-id="solution-to-question-9a">Solution to Question 9a</h4>
<hr>
<p>Replace all nine <code>??</code> in the code cell below with appropriate code. Then run the completed code to generate a bootstrap distribution and mark the observed difference in sample means (in red) and the mean of the bootstrap distribution (in blue) with vertical lines.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">5</span>  <span class="co"># Number of bootstrap samples</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>boot.diff.mean <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)  <span class="co"># create vector to store bootstrap proportions</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># for loop that creates bootstrap dist</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  x.non <span class="ot">&lt;-</span> <span class="fu">sample</span>(??, <span class="at">size =</span> ??, <span class="at">replace =</span> ??)  <span class="co"># pick a bootstrap resample</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  x.smoker <span class="ot">&lt;-</span> <span class="fu">sample</span>(??, <span class="at">size =</span> ??, <span class="at">replace =</span> ??)  <span class="co"># pick a bootstrap resample</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  boot.diff.mean[i] <span class="ot">&lt;-</span> ??  <span class="co"># compute difference in sample means</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plot bootstrap distribution</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(boot.diff.mean,  </span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks=</span><span class="dv">20</span>, </span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"x.bar.non - x.bar.smoker (in grams)"</span>,</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Bootstrap Distribution for Difference in Means"</span>)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="co"># red line at the observed  difference in sample means</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ??, <span class="at">col =</span> <span class="st">"firebrick2"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="co"># blue line at the center of bootstrap dist</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ??, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="question-9b" class="level3">
<h3 class="anchored" data-anchor-id="question-9b">Question 9b</h3>
<hr>
<p>Complete the code cell below to give a 95% bootstrap percentile confidence interval to estimate the difference in the mean birth weight of all babies born to non-smokers compared the to mean birth of all babies born to smokers. <em>Include units in your answer.</em></p>
<section id="solution-to-question-9b" class="level4">
<h4 class="anchored" data-anchor-id="solution-to-question-9b">Solution to Question 9b</h4>
<hr>
<p><strong>Based on the output below, a 95% bootstrap percentile confidence interval is from ?? to ??.</strong></p>
<p><br><br>
<br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find cutoffs for 95% bootstrap CI</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>lower.bwt<span class="fl">.95</span> <span class="ot">&lt;-</span> <span class="fu">quantile</span>(??, <span class="at">probs =</span> ??)  <span class="co"># find lower cutoff</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>upper.bwt<span class="fl">.95</span> <span class="ot">&lt;-</span> <span class="fu">quantile</span>(??, <span class="at">probs =</span> ??)  <span class="co"># find upper cutoff</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># print to screen</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>lower.bwt<span class="fl">.95</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>upper.bwt<span class="fl">.95</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="sec-interpret" class="level3">
<h3 class="anchored" data-anchor-id="sec-interpret">Question 9c</h3>
<hr>
<p>Interpret the practical meaning of your interval estimate in <a href="#question-9b">Question 9b</a>. Do you think it is plausible to conclude smoking does have an effect on the weight of a newborn? Explain why or why not.</p>
<section id="solution-to-question-9c" class="level4">
<h4 class="anchored" data-anchor-id="solution-to-question-9c">Solution to Question 9c</h4>
<hr>
<p><br><br>
<br><br>
<br></p>
<hr>
<p><img src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" class="img-fluid" alt="Creative Commons License"> <nbsp></nbsp></p>
<p><em>Statistical Methods: Exploring the Uncertain</em> by <a href="https://github.com/CU-Denver-MathStats-OER/Statistical-Theory">Adam Spiegler</a> is licensed under a <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.</p>


</section>
</section>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p><a href="https://www.epa.gov/ozone-pollution-and-your-patients-health/what-ozone">Ozone pollution and your patients health</a>, by the EPA accessed June 26, 2023.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Bruntz, Cleveland, Kleiner, and Warner. (1974). “The Dependence of Ambient Ozone on Solar Radiation, Wind, Temperature, and Mixing Height”. In <em>Symposium on Atmospheric Diffusion and Air Pollution</em>. American Meteorological Society, Boston.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Baystate Medical Center, Springfield, Massachusetts<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./16-Bootstrap-Dist.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">5.1: Bootstrap Distributions</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./18-Bootstrap-Other-Stats.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-title">5.3: Bootstrapping Comparitive Statistics</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Statistical Methods: Exploring the Uncertain by Adam Spiegler</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right"><img src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" class="img-fluid" alt="Creative Commons License"> <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-N-SA 4.0</a></div>
  </div>
</footer>



</body></html>