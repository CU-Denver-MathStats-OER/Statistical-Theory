<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Adam Spiegler, University of Colorado Denver">

<title>An Overview of Plotting Data in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">An Overview of Plotting Data in R</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Adam Spiegler, University of Colorado Denver </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://githubtocolab.com/CU-Denver-MathStats-OER/Statistical-Theory/blob/main/Appendix/Overview-of-Plots.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" class="img-fluid figure-img"></a></p>
<figcaption class="figure-caption">Open In Colab</figcaption>
</figure>
</div>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<hr>
<p>Plots can provide a useful visual summary of the data. Sometimes, a nice plot or two is all that is need for statistical analysis. In this document, we cover a basic overview of creating some plots in R.</p>
<p>Here’s a link to a more thorough coverage of plotting in R: <a href="https://r-graph-gallery.com/index.html" class="uri">https://r-graph-gallery.com/index.html</a>.</p>
<section id="help-documentation" class="level2">
<h2 class="anchored" data-anchor-id="help-documentation">Help Documentation</h2>
<hr>
<p>The plotting functions introduced in this document have robust help documentation with lots of options to customize your plots. If you want to view help documentation for any of the functions used in this document, run commands such<code>?hist</code>, <code>?plot</code>, <code>?table</code>, and so on.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># access help documentation for hist</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>?hist  <span class="co">#Side panel should open with help doc</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="what-are-packages-in-r" class="level1">
<h1>What Are Packages in R?</h1>
<hr>
<p>R packages are a collection functions, sample data, and/or other code scripts. R installs a set of default packages during installation.</p>
<p><strong>Run the code cell below to get a list of all default R packages that are already installed.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># See a list of installed default packages</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>allpack <span class="ot">&lt;-</span> <span class="fu">installed.packages</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(allpack)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="loading-packages-with-the-library-command" class="level2">
<h2 class="anchored" data-anchor-id="loading-packages-with-the-library-command">Loading Packages with the <code>library()</code> Command</h2>
<hr>
<p>Each time we start or restart a new session and want to access the library of functions and data in the package, we need to load the library of files in the package with the <code>library()</code> command.</p>
<p>To demonstrate how to create common statistical plots in R, we will use the <code>storms</code> data set which is located in the package <code>dplyr</code>.</p>
<ul>
<li>The <code>dplyr</code> package is already installed in Google Colaboratory</li>
<li>We still need to use a <code>library</code> command to load the package.</li>
<li><strong>Run the code cell below to load the <code>dplyr</code> package.</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the library of functions and data in dplyr</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="reloading-packages-when-restarting-a-session" class="level2">
<h2 class="anchored" data-anchor-id="reloading-packages-when-restarting-a-session">Reloading Packages When Restarting a Session</h2>
<hr>
<p>If we take a break in our work, it is possible our R session will time out and close. <span style="color:tomato"><strong>Each time we restart an R session, we will need to rerun <code>library()</code> commands in order reload any packages we plan to use</strong></span>.</p>
<p>The same caution applies to any objects, vectors, or data frames we create or edit in an R session. If a session times out, and we want to use an object <code>x</code> that we previously created, we will need to run the code cell(s) where object <code>x</code> is created again before we can refer back to <code>x</code> in the current session.</p>
<p><strong>BE SURE YOU RUN THE COMMAND <code>library(dplyr)</code> BEFORE ATTEMPTING TO RUN ANY OF THE CODE CELLS BELOW!</strong></p>
</section>
</section>
<section id="summarizing-storms-data" class="level1">
<h1>Summarizing <code>storms</code> Data</h1>
<hr>
<p>The package <code>dplyr</code> contains a data set called <code>storms</code>. Let’s find some useful information about this data.</p>
<ul>
<li>The first code cell below will open the help manual for <code>storms</code> in a side bar.
<ul>
<li>Feel free to close the help side bar.</li>
</ul></li>
<li>The second code cell below will provide a numeric summary of all variables in the <code>storms</code> data.</li>
<li>Recall we need to first run the command <code>library(dplyr)</code> in the code cell above to be able to access <code>storms</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># be sure to run the code cell above first</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># so you have loaded the dplyr package</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>?storms  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># See a summary of all variables</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(storms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     name                year          month             day       
 Length:19066       Min.   :1975   Min.   : 1.000   Min.   : 1.00  
 Class :character   1st Qu.:1993   1st Qu.: 8.000   1st Qu.: 8.00  
 Mode  :character   Median :2004   Median : 9.000   Median :16.00  
                    Mean   :2002   Mean   : 8.699   Mean   :15.78  
                    3rd Qu.:2012   3rd Qu.: 9.000   3rd Qu.:24.00  
                    Max.   :2021   Max.   :12.000   Max.   :31.00  
                                                                   
      hour             lat             long                         status    
 Min.   : 0.000   Min.   : 7.00   Min.   :-109.30   tropical storm     :6684  
 1st Qu.: 5.000   1st Qu.:18.40   1st Qu.: -78.70   hurricane          :4684  
 Median :12.000   Median :26.60   Median : -62.25   tropical depression:3525  
 Mean   : 9.094   Mean   :26.99   Mean   : -61.52   extratropical      :2068  
 3rd Qu.:18.000   3rd Qu.:33.70   3rd Qu.: -45.60   other low          :1405  
 Max.   :23.000   Max.   :70.70   Max.   :  13.50   subtropical storm  : 292  
                                                    (Other)            : 408  
    category          wind           pressure      tropicalstorm_force_diameter
 Min.   :1.000   Min.   : 10.00   Min.   : 882.0   Min.   :   0.0              
 1st Qu.:1.000   1st Qu.: 30.00   1st Qu.: 987.0   1st Qu.:   0.0              
 Median :1.000   Median : 45.00   Median :1000.0   Median : 110.0              
 Mean   :1.898   Mean   : 50.02   Mean   : 993.6   Mean   : 146.3              
 3rd Qu.:3.000   3rd Qu.: 65.00   3rd Qu.:1007.0   3rd Qu.: 220.0              
 Max.   :5.000   Max.   :165.00   Max.   :1024.0   Max.   :1440.0              
 NA's   :14382                                     NA's   :9512                
 hurricane_force_diameter
 Min.   :  0.00          
 1st Qu.:  0.00          
 Median :  0.00          
 Mean   : 14.81          
 3rd Qu.:  0.00          
 Max.   :300.00          
 NA's   :9512            </code></pre>
</div>
</div>
</section>
<section id="one-quantitative-variable" class="level1">
<h1>One Quantitative Variable</h1>
<hr>
<p>Often a graph or plot is a more preferred format to summarize a variable than a summary statistics. The documentation below explains we could graphically summarize the quantitative variable <code>pressure</code>.</p>
<section id="histograms" class="level2">
<h2 class="anchored" data-anchor-id="histograms">Histograms</h2>
<hr>
<p>The <code>hist</code> function can be used create a <span style="color:dodgerblue"><strong>histogram</strong></span> of a numerical vector.</p>
<ul>
<li>See histogram documentation: <a href="https://r-graph-gallery.com/histogram.html" class="uri">https://r-graph-gallery.com/histogram.html</a></li>
<li>Like making colorful plots? <a href="https://bookdown.org/hneth/ds4psy/D-3-apx-colors-basics.html">Here’s a guide to colors in R</a>.</li>
<li>We use a <code>$</code> symbol to indicate the name of the variable in <code>storms</code> we will access in the plot.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(storms<span class="sc">$</span>pressure,  <span class="co"># plot pressure variable in storms data</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"storm pressure (in millibars)"</span>,  <span class="co"># x-axis label</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Distribution of Storm Pressure"</span>,  <span class="co"># main title</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">10</span>,  <span class="co"># number of breaks or bins</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"aquamarine4"</span>)  <span class="co"># color of bars</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="density-plots" class="level2">
<h2 class="anchored" data-anchor-id="density-plots">Density plots</h2>
<hr>
<p>A histogram is more sensitive to its options. For example, a histogram with 3 breaks may tell a different story than plotting the same data with 20 breaks.</p>
<p>Thus, we may prefer to use a <span style="color:dodgerblue"><strong>density plot</strong></span>.</p>
<ol type="1">
<li>First compute density of <code>pressure</code>.</li>
</ol>
<ul>
<li>For more information, see <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/density">density help documentation</a>.</li>
</ul>
<ol start="2" type="1">
<li>The <code>plot()</code> function will then create a density plot.</li>
</ol>
<ul>
<li>For more advanced density plots see <a href="https://r-graph-gallery.com/density-plot.html" class="uri">https://r-graph-gallery.com/density-plot.html</a>.</li>
<li>If a variable is categorical, <code>plot()</code> will create a different plot, namely a bar chart.</li>
<li><code>plot()</code> can also be used to generate a plot to compare two different variables.</li>
<li>The output of <code>plot()</code> depends on the type and number of variables that we input in the function.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># approximate densities and then plot</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(storms<span class="sc">$</span>pressure),</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"storm pressure (in millibars)"</span>,  <span class="co"># horizontal axis label</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Distribution of Storm Pressure"</span>)  <span class="co"># main title</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="boxplots" class="level2">
<h2 class="anchored" data-anchor-id="boxplots">Boxplots</h2>
<hr>
<p><span style="color:dodgerblue"><strong>Boxplots</strong></span> are another useful plot for presenting the distribution of a quantitative variable using quartiles and the five number summary.</p>
<ul>
<li>See boxplot documentation at <a href="https://r-graph-gallery.com/boxplot.html" class="uri">https://r-graph-gallery.com/boxplot.html</a>.</li>
<li>Run the command <code>?boxplot</code> to see more options.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create boxplot of quantitative variable</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(storms<span class="sc">$</span>pressure,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"storm pressure (in millibars)"</span>,  <span class="co"># horizontal axis label</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">"gold"</span>,  <span class="co"># color of box</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Distribution of Storm Pressure"</span>)  <span class="co"># main title</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="changing-the-layout-of-boxplots" class="level3">
<h3 class="anchored" data-anchor-id="changing-the-layout-of-boxplots">Changing the Layout of Boxplots</h3>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># horizontally aligned boxplot</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(storms<span class="sc">$</span>pressure,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">horizontal =</span> <span class="cn">TRUE</span>,  <span class="co"># display horizontally</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"storm pressure (in millibars)"</span>,  <span class="co"># horizontal axis label</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Distribution of Storm Pressure"</span>,  <span class="co"># main title</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">"azure3"</span>)  <span class="co"># color</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="one-qualitative-variable" class="level1">
<h1>One Qualitative Variable</h1>
<hr>
<p>Qualitative (also called categorical) variables required other types of plots. For example, we cannot create a density or boxplot for a qualitative variable. Qualitative variables may be stored as characters (such as the <code>status</code> variable) or values (such as the <code>category</code> variable). This brings up a good question:</p>
<blockquote class="blockquote">
<p>How can we tell whether a variable is stored as a numerical variable, a categorical variable, or perhaps as a string of characters?</p>
</blockquote>
<section id="checking-the-data-type" class="level2">
<h2 class="anchored" data-anchor-id="checking-the-data-type">Checking the Data Type</h2>
<hr>
<p><strong>The <code>typeof()</code> command can help identify what is the type of a variable.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(storms<span class="sc">$</span>status)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(storms<span class="sc">$</span>category)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
</div>
<section id="data-types" class="level3">
<h3 class="anchored" data-anchor-id="data-types">Data Types</h3>
<hr>
<p>From the output above, we see:</p>
<ul>
<li>The variable <code>status</code> is initially read as an <code>integer</code>.</li>
<li>The individual values are <strong>strings of characters</strong> such as “tropical storm” or “hurricane”.</li>
<li>The summary statistics of <code>status</code> are <strong>counts</strong> that are stored as integers.</li>
<li>The variable <code>category</code> is initially read as <code>double</code> or decimal values.</li>
<li>The individual values are ordinal integers “1”, “2”, “3”, “4”, and “5” for category of hurricane.</li>
<li>There are 14,2328 <code>NA</code> (or missing) values corresponding to the observations that are not hurricanes.</li>
<li>The summary statistics of <code>category</code> (such as the mean) are stored decimals.</li>
<li>However, we would like to treat <code>category</code> as a qualitative variable and plot how many storms fall into each category.</li>
</ul>
</section>
</section>
<section id="caution-with-data-types-and-using-plot" class="level2">
<h2 class="anchored" data-anchor-id="caution-with-data-types-and-using-plot">Caution with Data Types and Using <code>plot()</code></h2>
<hr>
<p>If we try to use the general <code>plot()</code> function, R will give its best guess at which plot makes the most sense to display the data. If the data is stored as the wrong data type, <code>plot()</code> will not work as we might expect.</p>
<ul>
<li>Run the two code cells below, and notice the following:
<ul>
<li>The output of the <code>plot(storms$status)</code> looks like a reasonable bar chart.</li>
<li>The output of <code>plot(storms$category)</code> does not nicely summarize the counts of how many storms are in each category.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(storms<span class="sc">$</span>status)  <span class="co"># plot of status</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(storms<span class="sc">$</span>category)  <span class="co"># plot of category</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="creating-bar-charts-from-tables" class="level2">
<h2 class="anchored" data-anchor-id="creating-bar-charts-from-tables">Creating Bar Charts From Tables</h2>
<hr>
<p>The <code>table()</code> function will count the number of times a value (or string of characters) occurs in a vector or variable.</p>
<ul>
<li><a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/table">Official Documentation Page for <code>table()</code></a></li>
<li><a href="https://www.statology.org/table-function-in-r/">Another nice resource with examples</a></li>
</ul>
<p>One way to improve the initial plot of categories above is as follows:</p>
<ol type="1">
<li>First use the <code>table()</code> command to count how many storms are in each category.</li>
<li>Then create a bar chart using the <code>barplot()</code> function.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>cat.table <span class="ot">&lt;-</span> <span class="fu">table</span>(storms<span class="sc">$</span>category)  <span class="co"># create table of counts</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>cat.table  <span class="co"># print table to screen</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   1    2    3    4    5 
2478  973  579  539  115 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create bar chart from table counts</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(cat.table,  <span class="co"># input table from previous code cell</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Distribution of Hurricane Categories"</span>,  <span class="co"># main title</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Hurricane Category"</span>,  <span class="co"># horizontal axis label</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Frequency"</span>,  <span class="co"># vertical axis label</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">"steelblue"</span>)  <span class="co"># fill color of bars</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="relative-frequency-tables-and-bar-charts" class="level2">
<h2 class="anchored" data-anchor-id="relative-frequency-tables-and-bar-charts">Relative Frequency Tables and Bar Charts</h2>
<hr>
<p>If instead of plotting the number of hurricanes in each category we wish to plot the <strong>proportion</strong> of all hurricanes in each category, we can use the <code>prop.table()</code> function to convert the table counts to proportions relative to the grand total.</p>
<p><strong>Run the two code cells below to create a relative frequency bar chart.</strong></p>
<ol type="1">
<li>We input our previous table of counts, <code>cat.table</code>, into the function <code>prop.table()</code> to convert counts to proportions.</li>
<li>Then we create a bar chart of the resulting proportions.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>cat.prop <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(cat.table)  <span class="co"># create table of proportions</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(cat.prop,  <span class="co"># input table of proportions</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Relative Frequency of Hurricane Categories"</span>,  <span class="co"># main title</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Hurricane Category"</span>,  <span class="co"># horizontal axis label</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Proportion"</span>,  <span class="co"># vertical axis label</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">"steelblue"</span>)  <span class="co"># fill color of bars</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution with <code>prop.table()</code>
</div>
</div>
<div class="callout-body-container callout-body">
<hr>
<ul>
<li><span style="color:tomato">The input into <code>prop.table()</code> must be a table rather than a vector or data frame column.</span></li>
<li>The code cell below does return a relative frequency table as we would expect since we did not <span style="color:dodgerblue">first create a table of counts from <code>storms$category</code></span>.</li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(storms<span class="sc">$</span>category)  <span class="co"># do not input a vector</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(temp)  <span class="co">#  print first several entries of result</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA NA NA NA NA NA</code></pre>
</div>
</div>
</section>
<section id="pie-charts-with-pie" class="level2">
<h2 class="anchored" data-anchor-id="pie-charts-with-pie">Pie Charts with <code>pie()</code></h2>
<hr>
<p><span style="color:dodgerblue"><strong>Pie charts</strong></span> can also be used to illustrate the distribution of one qualitative variable.</p>
<ul>
<li>See <a href="https://r-graph-gallery.com/pie-plot.html" class="uri">https://r-graph-gallery.com/pie-plot.html</a>.</li>
<li>For help and a list of options, you can run <code>?pie</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>?pie</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create pie chart of one qualitative variable</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pie</span>(cat.table,  <span class="co"># input table</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"Distribution of Hurricane Categories"</span>)  <span class="co"># main title</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="converting-to-a-factor-and-then-plot" class="level2">
<h2 class="anchored" data-anchor-id="converting-to-a-factor-and-then-plot">Converting to a <code>factor()</code> and Then <code>plot()</code></h2>
<hr>
<p>One common issue with a qualitative variable is that it is often stored as the wrong datatype.</p>
<ul>
<li><span style="color:dodgerblue"><strong>Qualitative data should typically be stored as a <code>factor</code>.</strong></span></li>
</ul>
<p>Another way we can create a bar chart of the counts in each category is to:</p>
<ol type="1">
<li>First convert the qualitative variable to a <code>factor</code>.</li>
<li>Then use <code>plot()</code> to create an appropriate plot.</li>
</ol>
<p><strong>Run the code cell below to first see the summary output of the <code>category</code> variable after converting it to a <code>factor</code>.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creates a copy of storms data set</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># so we don't overwrite original storms</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>storms2 <span class="ot">&lt;-</span> storms  </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>storms2<span class="sc">$</span>category <span class="ot">&lt;-</span> <span class="fu">factor</span>(storms<span class="sc">$</span>category)  <span class="co"># convert category to factor</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(storms2<span class="sc">$</span>category)  <span class="co"># get new summary of categories</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    1     2     3     4     5  NA's 
 2478   973   579   539   115 14382 </code></pre>
</div>
</div>
<p>Notice the summary is a table of counts in each hurricane category.</p>
<ul>
<li>Once the variable <code>status</code> is converted to a <code>factor</code>, the <code>plot()</code> function will know to use a bar chart to give a summary display.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create bar chart from counts of a factor</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(storms2<span class="sc">$</span>category,  <span class="co"># input a factor</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Distribution of Hurricane Category"</span>,  <span class="co"># main title</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Hurrican Category"</span>,  <span class="co"># horizontal axis label</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Frequency"</span>,  <span class="co"># vertical axis label</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"steelblue"</span>)  <span class="co"># color of fill of ba</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><span style="color:tomato"><strong>Recall without first changing <code>category</code> to a <code>factor</code>, <code>plot()</code> will create a different graph.</strong></span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># default plot of category when not first converted to factor</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(storms<span class="sc">$</span>category)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="plotting-one-quantitative-and-one-qualitative-variable" class="level1">
<h1>Plotting One Quantitative and One Qualitative Variable&lt;</h1>
<hr>
<p>Imagine we would like to compare the wind speeds of storms by status. In this case, we would like to compare a quantitative variable (<code>wind</code>) for different classes of a qualitative variable (<code>status</code>).</p>
<section id="side-by-side-boxplots" class="level2">
<h2 class="anchored" data-anchor-id="side-by-side-boxplots">Side by Side Boxplots</h2>
<hr>
<p>There are many classes of storms status in <code>storms</code>.</p>
<p>In the storms data:</p>
<ul>
<li><code>wind</code> is a quantitative variable.</li>
<li><code>status</code> is a qualitative variable.</li>
<li>We can use the default <code>plot()</code> function to create a side by side boxplots.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a vector of fill colors</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># one color for each status type.</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>my.colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"green"</span>, <span class="st">"purple"</span>, <span class="st">"grey"</span>, <span class="st">"red"</span>, </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"blue"</span>, <span class="st">"gold"</span>, <span class="st">"cyan"</span>, <span class="st">"pink"</span>, <span class="st">"orange"</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wind <span class="sc">~</span> status,  <span class="co"># quantitative first ~ categorical second</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> storms,  <span class="co"># name of data frame</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> my.colors,  <span class="co"># fill colors</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Wind Speeds of Storms by Status"</span>)  <span class="co"># main title</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="adding-a-legend-to-plots" class="level3">
<h3 class="anchored" data-anchor-id="adding-a-legend-to-plots">Adding a Legend to Plots</h3>
<hr>
<ul>
<li>There are a lot of different status of storms.</li>
<li>It is not easy (or possible) to tell which boxplot corresponds to which storm status.</li>
<li>Adding a <span style="color:dodgerblue"><strong>legend</strong></span> to the plot will help!</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a table of status counts</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># we will pull of the row names of the table</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># as the labels in the legend</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>status.table <span class="ot">&lt;-</span> <span class="fu">table</span>(storms<span class="sc">$</span>status)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wind <span class="sc">~</span> status,  <span class="co"># quantitative first ~ categorical second</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> storms,  <span class="co"># name of data frame</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> my.colors,  <span class="co"># fill colors colors</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Wind speed in knots"</span>,  <span class="co"># vertical axis label</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Wind Speeds of Storms by Status"</span>)  <span class="co"># main title</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># we can add a legend to identify which plot is which storm status</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="st">"topright"</span>,  <span class="co"># place legend in top right corner</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">rownames</span>(status.table),  <span class="co"># each row of table is label in legend</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> my.colors)  <span class="co"># fill colors</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="subsetting-data-by-category" class="level2">
<h2 class="anchored" data-anchor-id="subsetting-data-by-category">Subsetting Data by Category</h2>
<hr>
<p>There are many classes of storms status in <code>storms</code>. Often, we want to only focus on a smaller subset of classes. We can restrict our attention to compare the wind speeds of three of the classes: “tropical storm”, “tropical depression”, and “hurricane”.</p>
<ul>
<li>We can <span style="color:dodgerblue"><strong>subset</strong></span> <code>storms</code> data frame into three separate data frames, one for each status of storm, using the <code>subset()</code> function.</li>
<li>Curious to learn more about <code>subset</code>? Run <code>?subset</code> in a code cell to access help documentation.</li>
<li>Then we can create three separate boxplots of the wind speeds for each status.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># split data by storm status</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>hur <span class="ot">&lt;-</span> <span class="fu">subset</span>(storms,  <span class="co"># data frame name</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>              status <span class="sc">==</span> <span class="st">"hurricane"</span>,  <span class="co"># logical test to select observations</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">select =</span> wind)  <span class="co"># which quantitative variable(s) to select</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>trop.storm <span class="ot">&lt;-</span> <span class="fu">subset</span>(storms, </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>                     status <span class="sc">==</span> <span class="st">"tropical storm"</span>,  <span class="co"># tropical storms</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">select =</span> wind)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>trop.dep <span class="ot">&lt;-</span> <span class="fu">subset</span>(storms, </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>                   status <span class="sc">==</span> <span class="st">"tropical depression"</span>,   <span class="co"># tropical depressions</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">select =</span> wind)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co"># create side by side boxplot</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co"># for each of the three subsets</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(hur<span class="sc">$</span>wind, trop.storm<span class="sc">$</span>wind, trop.dep<span class="sc">$</span>wind, </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Windspeed of Storms"</span>, </span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Hurricanes"</span>, <span class="st">"Tropical Storms"</span>, <span class="st">"Tropical Depressions"</span>), </span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>), </span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Wind speed in knots"</span>, </span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">horizontal =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="relationship-between-two-qualitative-variables" class="level1">
<h1>Relationship Between Two Qualitative Variables</h1>
<hr>
<p>Imagine we would like to compare the number of different category hurricanes that occurred in each month. In this case, we would like to compare two qualitative variables, namely <code>category</code> and <code>month</code>.</p>
<section id="creating-contingency-or-two-way-table" class="level2">
<h2 class="anchored" data-anchor-id="creating-contingency-or-two-way-table">Creating Contingency or Two-Way Table</h2>
<hr>
<p>The command <code>table(x)</code> will count the number of times a value (or string of characters) occurs in a vector <code>x</code>.</p>
<ul>
<li><a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/table">Official Documentation Page for <code>table()</code></a></li>
<li><a href="https://www.statology.org/table-function-in-r/">Nice resource with examples</a></li>
</ul>
<p>The command <code>table(x, y)</code> will similarly create a contingency (or two-way) table to jointly compare counts of <code>x</code> and <code>y</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a contingency table for status and month</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>con.table <span class="ot">&lt;-</span> <span class="fu">table</span>(storms<span class="sc">$</span>category, storms<span class="sc">$</span>month) </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>con.table  <span class="co"># print output to screen</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
       1    4    5    6    7    8    9   10   11   12
  1    5    0    0   18  140  581 1099  462  140   33
  2    0    0    0    0   25  198  571  150   29    0
  3    0    0    0    0   18  113  346   86   16    0
  4    0    0    0    0   18  114  295   88   24    0
  5    0    0    0    0    1   32   69   13    0    0</code></pre>
</div>
</div>
</section>
<section id="creating-grouped-frequency-bar-charts" class="level2">
<h2 class="anchored" data-anchor-id="creating-grouped-frequency-bar-charts">Creating Grouped Frequency Bar Charts</h2>
<hr>
<p>After creating a two-way table, we can present the results visually in a <span style="color:dodgerblue"><strong>grouped bar chart</strong></span>.</p>
<ul>
<li>See documentation at <a href="https://r-graph-gallery.com/211-basic-grouped-or-stacked-barplot.html" class="uri">https://r-graph-gallery.com/211-basic-grouped-or-stacked-barplot.html</a>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a vector of colors</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>my.colors2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"green"</span>, <span class="st">"purple"</span>, <span class="st">"grey"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span>) </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create side by side bar chart</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(con.table,  <span class="co"># use counts from contingency table</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">beside =</span> <span class="cn">TRUE</span>,  <span class="co"># groups side-by-side</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Category Hurricanes By Month"</span>,  <span class="co"># main title</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Month"</span>,  <span class="co"># horizontal axis label</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> my.colors2,  <span class="co"># fill color of bars</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Frequency"</span>)  <span class="co"># vertical axis label</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co"># add a legend to plot</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x=</span><span class="st">"topleft"</span>,  <span class="co"># place legend in top left</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">rownames</span>(con.table),  <span class="co"># get labels from row name in contingency table</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> my.colors2)  <span class="co"># use same fill colors</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="grouped-frequency-bar-charts" class="level2">
<h2 class="anchored" data-anchor-id="grouped-frequency-bar-charts">Grouped Frequency Bar Charts</h2>
<hr>
<ul>
<li>Note <code>beside = FALSE</code> is the default.</li>
<li>If we do not specify a <code>beside</code> option, a <strong>stacked bar chart</strong> is created instead.</li>
<li>In the second code cell, we also add a legend to the plot.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="do">########################################################</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Note this has already been run in a previous section</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># You do not need to run again if already created</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create a contingency table for status and month</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>con.table <span class="ot">&lt;-</span> <span class="fu">table</span>(storms<span class="sc">$</span>category, storms<span class="sc">$</span>month) </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>con.table  <span class="co"># print output to screen</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a vector of colors</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>my.colors2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"green"</span>, <span class="st">"purple"</span>, <span class="st">"grey"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span>) </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create stacked bar chart</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(con.table,  <span class="co"># use counts from contingency table</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Category Hurricanes By Month"</span>,  <span class="co"># main title</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Month"</span>,  <span class="co"># horizontal axis label</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> my.colors2,  <span class="co"># color of bars</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Frequency"</span>)  <span class="co"># vertical axis label</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co"># add legend to plot</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x=</span><span class="st">"topleft"</span>,  <span class="co"># place legend in top left</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">rownames</span>(con.table),  <span class="co"># get labels</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> my.colors2)  <span class="co"># use same colors</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="stacked-bar-charts-relative-to-grand-total" class="level2">
<h2 class="anchored" data-anchor-id="stacked-bar-charts-relative-to-grand-total">Stacked Bar Charts Relative to Grand Total</h2>
<hr>
<ol type="1">
<li>First we create a contingency table using <code>table(x, y)</code>.</li>
<li>Then we use <code>prop.table([table_name])</code> to convert to frequencies to proportions out of the grand total.</li>
<li>Finally we can create a group bar chart of relative frequencies.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create two-table of counts</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>con.table <span class="ot">&lt;-</span> <span class="fu">table</span>(storms<span class="sc">$</span>category, storms<span class="sc">$</span>month)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># convert counts to proportions</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>con.prop <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(con.table) </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create a vector of colors</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>my.colors2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"green"</span>, <span class="st">"purple"</span>, <span class="st">"grey"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span>) </span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="co"># create stacked bar chart</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(con.table,  <span class="co"># use counts from contingency table</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Category Hurricanes By Month"</span>,  <span class="co"># main title</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Month"</span>,  <span class="co"># horizontal axis label</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> my.colors2,  <span class="co"># color of bars</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Relative Frequency (of grand total)"</span>)  <span class="co"># vertical axis label</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x=</span><span class="st">"topleft"</span>,  <span class="co"># place legend in top left</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">rownames</span>(con.table),  <span class="co"># get labels</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> my.colors)  <span class="co"># use same fill colors</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="stacked-bar-chart-relative-to-column-totals" class="level2">
<h2 class="anchored" data-anchor-id="stacked-bar-chart-relative-to-column-totals">Stacked Bar Chart Relative to Column Totals</h2>
<hr>
<p>Often, we would like the proportions in the table to be computed out of the total in each column (instead of the grand total).</p>
<ul>
<li>We add the option <code>2</code> inside <code>prop.table()</code>.</li>
<li>In this example, each column is a different month.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create two-table of counts</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>con.table <span class="ot">&lt;-</span> <span class="fu">table</span>(storms<span class="sc">$</span>category, storms<span class="sc">$</span>month)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># convert counts to proportions</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># note the option 2 added to command below</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>con.prop.column <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(con.table, <span class="dv">2</span>)  </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co"># create a vector of colors</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>my.colors2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"green"</span>, <span class="st">"purple"</span>, <span class="st">"grey"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span>) </span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co"># create stacked bar chart</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(con.prop.column,  <span class="co"># use counts from contingency table</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Category Hurricanes By Month"</span>,  <span class="co"># main title</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Month"</span>,  <span class="co"># horizontal axis label</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> my.colors2,  <span class="co"># color of bars</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Relative Frequency (to month totals"</span>)  <span class="co"># vertical axis label</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x=</span><span class="st">"topleft"</span>,  <span class="co"># place legend in top left</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">rownames</span>(con.table),  <span class="co"># get labels</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> my.colors)  <span class="co"># use same fill colors</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="relationship-between-two-quantitative-variables" class="level1">
<h1>Relationship Between Two Quantitative Variables</h1>
<hr>
<p>Imagine we would like to compare the wind speeds (<code>wind</code>) to the pressure (<code>pressure</code>). In this case, we would like to compare two quantitative variables.</p>
<p>A <span style="color:dodgerblue"><strong>scatter plot</strong></span> can be used to identify the relationship between two quantitative variables.</p>
<ul>
<li><p><strong>If both variables are quantitative, the <code>plot()</code> function by default will create a scatter plot to compare the two variables.</strong></p></li>
<li><p>For other types of scatter plots, see documentation: <a href="https://r-graph-gallery.com/scatterplot.html" class="uri">https://r-graph-gallery.com/scatterplot.html</a>.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a scatter plot</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># first variable wind is response (y-axis)</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># second variable pressure is predictor (x-axis)</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wind <span class="sc">~</span> pressure,  <span class="co"># response ~ predictor(s)</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> storms,  <span class="co"># data frame name</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Relation of Pressure and Wind Speed of Storms"</span>,  <span class="co"># main title</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Pressure (in millibars)"</span>,  <span class="co"># horizontal axis label</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Wind Speed (in knots)"</span>)  <span class="co"># vertical axis label</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="arranging-multiple-plots-in-an-array" class="level1">
<h1>Arranging Multiple Plots in an Array</h1>
<hr>
<ul>
<li><p>The command <code>par(mfrow =c(n,m)</code> creates an array of <span class="math inline">\(n\)</span> rows and <span class="math inline">\(m\)</span> columns.</p></li>
<li><p>Plots will fill the array based on the order they are plotted.</p></li>
<li><p>See <a href="https://bookdown.org/ndphillips/YaRrr/arranging-plots-with-parmfrow-and-layout.html" class="uri">https://bookdown.org/ndphillips/YaRrr/arranging-plots-with-parmfrow-and-layout.html</a> for more info.</p></li>
<li><p>See previous sections for further information about each of the plots created below.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))  <span class="co"># create a 2 x 2 array of plots</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the next 5 plots created will be arranged in the array</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(storms<span class="sc">$</span>wind)  <span class="co"># create boxplot of wind speed</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># code below creates a histogram of wind speed</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># we can add many options to customize</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(storms<span class="sc">$</span>wind, <span class="at">xlab =</span> <span class="st">"wind speed (in knots)"</span>,   <span class="co"># x-axis label</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Frequency"</span>,  <span class="co"># y-axis label</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Distribution of Storm Wind Speed 1975-2020"</span>,  <span class="co"># main label</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"steelblue"</span>)  <span class="co"># change color of bars</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(storms<span class="sc">$</span>status, <span class="at">col =</span> <span class="st">"gold"</span>)  <span class="co"># plots status, which is categorical</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wind <span class="sc">~</span> pressure, <span class="at">data =</span> storms)  <span class="co"># plots two numerical variables</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a table of status counts</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># we will pull of the row names of the table</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># as the labels in the legend</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>status.table <span class="ot">&lt;-</span> <span class="fu">table</span>(storms<span class="sc">$</span>status)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wind <span class="sc">~</span> status,  <span class="co"># quantitative first ~ categorical second</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">data =</span> storms,  <span class="co"># name of data frame</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> my.colors,  <span class="co"># fill colors colors</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Wind speed in knots"</span>,  <span class="co"># vertical axis label</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Wind Speeds of Storms by Status"</span>)  <span class="co"># main title</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="co"># we can add a legend to identify which plot is which storm status</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="st">"topright"</span>,  <span class="co"># place legend in top right corner</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">rownames</span>(status.table),  <span class="co"># each row of table is label in legend</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> my.colors)  <span class="co"># fill colors</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="more-advanced-plots-with-ggplot2" class="level1">
<h1>More Advanced Plots with <code>ggplot2</code></h1>
<hr>
<p>The previous plots were created using R’s <span style="color:dodgerblue"><strong>base</strong> graphics system</span>.</p>
<ul>
<li><strong>base</strong> graphics are fast and simple to produce while looking professional.</li>
</ul>
<p>A <span style="color:dodgerblue">fancier alternative is to construct plots using the <code>ggplot2</code> package.</span></p>
<ul>
<li>The <code>gg</code> stands for <strong>Grammar of Graphics</strong>.</li>
</ul>
<p>In its simplest form, to construct a (useful) plot in <code>ggplot2</code>, you need to provide:</p>
<ul>
<li><span style="color:dodgerblue">A <code>ggplot</code> object.</span>
<ul>
<li>This is usually the object that holds your data frame.</li>
<li>The data frame is passed to <code>ggplot</code> via the first <code>data</code> argument.</li>
</ul></li>
<li><span style="color:dodgerblue">A geometry object.</span>
<ul>
<li>Roughly speaking, this is the <em>kind</em> of plot you want.</li>
<li>e.g., <code>geom_histogram</code> for a histogram, <code>geom_point</code> for a scatter plot, <code>geom_density</code> for a density plot.</li>
</ul></li>
<li><span style="color:dodgerblue">An aesthetic mapping.</span>
<ul>
<li>Aesthetic mappings describe how variables in the data are mapped to visual properties of a geometry.</li>
<li>This is where you specify which variable with be the <code>x</code> variable, the <code>y</code> variable, which variable will control color in the plots, etc.</li>
</ul></li>
<li>See <a href="https://ggplot2.tidyverse.org" class="uri">https://ggplot2.tidyverse.org</a> for documentation.</li>
<li>Download a <a href="https://www.maths.usyd.edu.au/u/UG/SM/STAT3022/r/current/Misc/data-visualization-2.1.pdf">ggplot2 cheatsheet</a>.</li>
</ul>
<section id="loading-ggplot2" class="level2">
<h2 class="anchored" data-anchor-id="loading-ggplot2">Loading <code>ggplot2</code></h2>
<hr>
<ul>
<li><p>The <code>ggplot2</code> package is already installed as a default package in Google Colaboratory.</p></li>
<li><p>However, recall each time we start or restart a new session and want to access the library of functions and data in the package, we need to load the library of files in the package with the <code>library</code> command.</p></li>
<li><p><strong>Run the first code cell below to load the <code>ggplot2</code> package.</strong></p></li>
<li><p>If restarting a new session, you also need to reload the <code>dplyr</code> package to access <code>storms</code> data.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)  <span class="co"># make sure you have installed ggplot2 package</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># may need to reload</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plotting-one-numerical-variable-with-ggplot2" class="level2">
<h2 class="anchored" data-anchor-id="plotting-one-numerical-variable-with-ggplot2">Plotting One Numerical Variable with <code>ggplot2</code></h2>
<hr>
<p>To create various types of plots for one quantitative variable, such as <code>wind</code>:</p>
<ul>
<li>The <strong>ggplot object</strong> is the data frame <code>storms</code>.</li>
<li>The <strong>aesthetic</strong> is the variable <code>wind</code> that we will plot on the x-axis.</li>
<li>Geometric objects histogram, density, and boxplot are specified in each of the three code cells below.</li>
<li>There a numerous options we can include as well.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a histogram</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(storms, <span class="fu">aes</span>(<span class="at">x =</span> wind)) <span class="sc">+</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color=</span><span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a density plot</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(storms, <span class="fu">aes</span>(<span class="at">x =</span> wind)) <span class="sc">+</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="co"># adding theme_bw()  makes white background</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a boxplot</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(storms, <span class="fu">aes</span>(<span class="at">x =</span> wind)) <span class="sc">+</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"blueviolet"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="scatter-plots-with-ggplot2" class="level2">
<h2 class="anchored" data-anchor-id="scatter-plots-with-ggplot2">Scatter Plots with <code>ggplot2</code></h2>
<hr>
<p>To create a scatter plot to compare two quantitative variables such as wind speed and pressure of storms:</p>
<ul>
<li>The <strong>ggplot object</strong> is the data frame <code>storms</code>.</li>
<li>The <strong>aesthetic</strong> are the variables
<ul>
<li><code>pressure</code> is the predictor plotted on the x-axis.</li>
<li><code>wind</code> is the response plotted on the y-axis.t</li>
</ul></li>
<li>Geometric object is scatter.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a scatter plot</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(storms) <span class="sc">+</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> pressure, <span class="at">y =</span> wind))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="scaling-ggplot2-plots" class="level2">
<h2 class="anchored" data-anchor-id="scaling-ggplot2-plots">Scaling <code>ggplot2</code> plots</h2>
<hr>
<p>In general, <span style="color:dodgerblue"><strong>scaling</strong></span> is the process by which <code>ggplot2</code> maps variables to unique values. When this is done for discrete numeric or qualitative variables, <code>ggplot2</code> will often scale the variable to distinct colors, symbols, or sizes, depending on the aesthetic mapped.</p>
<p>In the example below, we map the <code>status</code> variable to the <code>color</code> aesthetic, which is then scaled to different colors for the different <code>status</code> levels.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scatter plot with scaling</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(storms) <span class="sc">+</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> pressure, <span class="at">y =</span> wind, <span class="at">color =</span> status))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="scaling-by-shape" class="level3">
<h3 class="anchored" data-anchor-id="scaling-by-shape">Scaling by Shape</h3>
<hr>
<p>Alternatively, we can map the <code>status</code> variable to the <code>shape</code> aesthetic, which creates a plot with different shapes for each observation based on the <code>status</code> level.</p>
<ul>
<li>By default, 6 shapes can be used.</li>
<li>There are 9 different status of storms.</li>
<li>The last option manually sets the shapes for each status to avoid an error.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scaling by shape</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(storms) <span class="sc">+</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> pressure, <span class="at">y =</span> wind, <span class="at">shape =</span> status)) <span class="sc">+</span> </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>)  <span class="co"># manually setting shapes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="applying-multiple-scales" class="level3">
<h3 class="anchored" data-anchor-id="applying-multiple-scales">Applying Multiple Scales</h3>
<hr>
<p>We can even combine these two aesthetic mappings in a single plot to get different colors and symbols for each level of <code>month</code> and <code>status</code>, respectively.</p>
<ul>
<li>By default, 6 shapes can be used.</li>
<li>There are 9 different status of storms.</li>
<li>The last option manually sets the shapes for each status to avoid an error.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scaling by month and status</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(storms) <span class="sc">+</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> pressure, <span class="at">y =</span> wind, <span class="at">color =</span> month, <span class="at">shape =</span> status)) <span class="sc">+</span> </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>)  <span class="co"># manually setting shapes for status</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="facetting-in-ggplot2" class="level2">
<h2 class="anchored" data-anchor-id="facetting-in-ggplot2">Facetting in <code>ggplot2</code></h2>
<hr>
<p><span style="color:dodgerblue"><strong>Faceting</strong></span> creates separate panels (facets) of a data frame based on one or more faceting variables.</p>
<p>To create various scatter plots (one for each category) to compare two quantitative variables such as wind speed and pressure of storms, we can add a <code>facet_grid</code>.</p>
<ul>
<li>Note the NA plot corresponds to the storms that are not hurricanes.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># faceting by category</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(storms) <span class="sc">+</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> pressure, <span class="at">y =</span> wind)) <span class="sc">+</span> </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> category)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="bar-charts-with-ggplot2" class="level2">
<h2 class="anchored" data-anchor-id="bar-charts-with-ggplot2">Bar Charts with <code>ggplot2</code></h2>
<hr>
<p>Imagine we would like to compare the number of different types of storms (<code>status</code>) that occurred in each month.</p>
<section id="stacked-bar-charts-of-counts-with-ggplot2" class="level3">
<h3 class="anchored" data-anchor-id="stacked-bar-charts-of-counts-with-ggplot2">Stacked Bar Charts of Counts with <code>ggplot2</code></h3>
<hr>
<p>To create a stacked bar chart of counts for one or more qualitative variable:</p>
<ul>
<li>The <strong>ggplot object</strong> is the data frame <code>storms</code>.</li>
<li>Geometric <strong>object</strong> is <code>geom_bar</code>.</li>
<li>The <strong>aesthetic</strong> is specified as:
<ul>
<li>Fill color, (<code>fill</code>) is <code>status</code>.</li>
<li>The height of each bar is summarizing the statistic (<code>stat</code>) is <code>"count"</code>.</li>
<li>The <code>position="stack"</code> creates a stacked bar chart of counts.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stacks bars on top of each other </span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(storms, <span class="fu">aes</span>(<span class="at">x=</span>month)) <span class="sc">+</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill=</span>status), <span class="at">stat =</span> <span class="st">"count"</span>, <span class="at">position=</span><span class="st">"stack"</span>) <span class="sc">+</span> </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Occurrence of Storms by Month"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="stacked-relative-frequency-bar-charts-with-ggplot2" class="level3">
<h3 class="anchored" data-anchor-id="stacked-relative-frequency-bar-charts-with-ggplot2">Stacked Relative Frequency Bar Charts with <code>ggplot2</code></h3>
<hr>
<p>To create a stacked bar chart of relative frequencies for two qualitative variables:</p>
<ul>
<li>The <strong>ggplot object</strong> is the data frame <code>storms</code>.</li>
<li>Geometric <strong>object</strong> is <code>geom_bar</code>.</li>
<li>The <strong>aesthetic</strong> is specified as:
<ul>
<li>Fill color, (<code>fill</code>) is <code>status</code>.</li>
<li>The height of each bar is summarizing the statistic (<code>stat</code>) is <code>"count"</code>.</li>
<li>The <code>position="fill"</code> creates a stacked bar chart of relative frequencies.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stacks bars and standardizing each stack</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(storms, <span class="fu">aes</span>(<span class="at">x=</span>month)) <span class="sc">+</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill=</span>status), <span class="at">stat =</span> <span class="st">"count"</span>, <span class="at">position=</span><span class="st">"fill"</span>) <span class="sc">+</span>  </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Occurrence of Storms by Month"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="grouped-bar-charts-of-counts-with-ggplot2" class="level3">
<h3 class="anchored" data-anchor-id="grouped-bar-charts-of-counts-with-ggplot2">Grouped Bar Charts of Counts with <code>ggplot2</code></h3>
<hr>
<p>To create various types of bar plots for one or more qualitative variables:</p>
<ul>
<li>The <strong>ggplot object</strong> is the data frame <code>storms</code>.</li>
<li>Geometric <strong>object</strong> is <code>geom_bar</code>.</li>
<li>The <strong>aesthetic</strong> is specified as:
<ul>
<li>Fill color, (<code>fill</code>) is <code>status</code>.</li>
<li>The height of each bar is summarizing the statistic (<code>stat</code>) is <code>"count"</code>.</li>
<li>The <code>position="dodge"</code> creates a stacked bar chart.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creates grouped bar chart</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(storms, <span class="fu">aes</span>(<span class="at">x=</span>month)) <span class="sc">+</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill=</span>status), <span class="at">stat =</span> <span class="st">"count"</span>, <span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span>  </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Occurrence of Storms by Month"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Overview-of-Plots_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="spatial-plots-with-mapview" class="level1">
<h1>Spatial Plots with <code>mapview</code></h1>
<hr>
<section id="load-library" class="level2">
<h2 class="anchored" data-anchor-id="load-library">Load Library</h2>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapview)  <span class="co"># load spatial mapping package</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mapping-all-storms-by-status" class="level2">
<h2 class="anchored" data-anchor-id="mapping-all-storms-by-status">Mapping All Storms by Status</h2>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mapview</span>(storms, <span class="at">xcol =</span> <span class="st">"long"</span>, <span class="at">ycol =</span> <span class="st">"lat"</span>, </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">zcol =</span> <span class="st">"status"</span>, </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">crs =</span> <span class="dv">4269</span>, <span class="at">grid =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mapping-category-5-hurricanes" class="level2">
<h2 class="anchored" data-anchor-id="mapping-category-5-hurricanes">Mapping Category 5 Hurricanes</h2>
<hr>
<p>First we filter out observations with <code>category</code> equal to 5.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>cat5 <span class="ot">&lt;-</span> <span class="fu">subset</span>(storms , category <span class="sc">==</span> <span class="st">"5"</span>)  <span class="co"># keep only category 5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mapview</span>(cat5, <span class="at">xcol =</span> <span class="st">"long"</span>, <span class="at">ycol =</span> <span class="st">"lat"</span>, <span class="at">cex =</span> <span class="st">"wind"</span>, <span class="at">crs =</span> <span class="dv">4269</span>, <span class="at">grid =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mapview</span>(cat5, <span class="at">xcol =</span> <span class="st">"long"</span>, <span class="at">ycol =</span> <span class="st">"lat"</span>, <span class="at">zcol =</span> <span class="st">"name"</span>, <span class="at">cex =</span> <span class="st">"wind"</span>, <span class="at">crs =</span> <span class="dv">4269</span>, <span class="at">grid =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="creative-commons-license-information" class="level1">
<h1>Creative Commons License Information</h1>
<hr>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Creative Commons License</figcaption>
</figure>
</div>
<p><em>Statistical Methods: Exploring the Uncertain</em> by <a href="https://github.com/CU-Denver-MathStats-OER/Statistical-Theory">Adam Spiegler (University of Colorado Denver)</a> is licensed under a <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>. This work is funded by an <a href="https://cdhe.colorado.gov/educators/administration/institutional-groups/open-educational-resources-in-colorado">Institutional OER Grant from the Colorado Department of Higher Education (CDHE)</a>.</p>
<p>For similar interactive OER materials in other courses funded by this project in the Department of Mathematical and Statistical Sciences at the University of Colorado Denver, visit <a href="https://github.com/CU-Denver-MathStats-OER" class="uri">https://github.com/CU-Denver-MathStats-OER</a>.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>