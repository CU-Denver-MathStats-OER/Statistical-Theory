{
  "hash": "a8e199400010d501cb95f22f4b6afb20",
  "result": {
    "markdown": "---\ntitle: '3.2: Sampling Distributions for Proportions'\n#author: 'Adam Spiegler, University of Colorado Denver'\noutput:\n  html_document:\n#    toc: yes\n#    toc_depth: 1\n#    theme: cerulean\n#jupyter:\n#  kernelspec:\n#    display_name: R\n#    language: R\n#    name: ir\n#output:\n\n#    ipynbdocument::ipynb_document\n---\n\n\n\n[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://githubtocolab.com/CU-Denver-MathStats-OER/Statistical-Theory/blob/main/Chap3/11-Sampling-Dist-Prop.ipynb){target=\"_blank\"} <nbsp>\n\n![Credit: [Bunch of Random Numbers](https://freesvg.org/bunch-of-random-numbers) in [Public Domain](https://creativecommons.org/licenses/publicdomain/), via freesvg](https://freesvg.org/img/Prismatic-Random-Numbers-Cloud.png){fig-align=\"left\" width=25% fig-alt=\"ImageBunch of random numbers\"} <nbsp>\n\n\nWe [previously used sampling distributions](10-Sampling-Dist-Mean.qmd){target=\"_blank\"} to describe the distribution of means computed from different random samples (each the same size) picked from the same population. The **standard error** (standard deviation of the sampling distribution) measures how much variability to expect due to the uncertainty in the sampling process. In many situations, a mean is not a relevant or helpful statistic, and other sample statistics, such as proportions, may be more applicable to the analysis. For example:\n\n> If a jury pool of 20 people are randomly selected from a population where 42% of eligible jurors indentify their political party as Independent, what is *fair* representation for Independents on the jury pool? \n\nBelow are some observations to help guide our investigation in this section:\n\n- The representation could be $8/20 = 0.40$, $9/20 = 0.45$, but not exactly 42%.\n  - A goal of perfect representation in all possible ways is impossible to meet.\n  - We should choose a more obtainable goal in this situation.\n  - The goal can vary based on factors such as the interests and backgrounds of the researchers.\n- The proportion of Independents varies from jury to jury.\n  - We can consider a range of fair values.\n  \n- Political affiliation is measured as a categorical variable.\n  - In the jury example, we consider two classes: \"Independent\" and \"Not Independent\".\n  \nThere is no natural \"mean\" to consider in this context since the data is categorical. We can however count the number of Independents in a pool of 20 randomly selected jurors and consider what is fair proportional representation? Constructing a sampling distribution for the <span style=\"color:dodgerblue\">**proportion**</span> of Independents on a randomly selected jury pool is more helpful than considering a distribution of sample means in this situation. \n\n\n# Sampling from a Binomial Distribution\n\n---\n\nFair representation on a jury is one example of a situation where analyzing a distribution of sample proportions may be appropriate. Very often we encounter statistical questions that ask us to approximate or compare proportions. For example\n\n-   What proportion of voters support a certain candidate running for office?\n-   What proportion of the population follow public health recommendations?\n-   What proportion of items manufactured are defective?\n\nWe can use a sampling distribution of proportions to help analyze statistical questions regarding proportions. In these situations:\n\n- We have a population in mind. *For example, all eligible jurors.*\n- A sample size. *For example, $n=20$ people in a jury pool.*\n- Count the number of \"successes\" in each sample. *How many independents, $X$, are in the pool?*\n  - We can model the probability of $X$ \"successes\" with a <span style=\"color:dodgerblue\">**binomial distribution**</span>. \n- Calculate the corresponding <span style=\"color:dodgerblue\">**sample proportion**</span> that we denote $\\color{dodgerblue}{\\hat{p}}$.\n \n\n$$\\color{dodgerblue}{\\boxed{\n\\hat{p} = \\frac{\\mbox{Number of successes}}{\\mbox{Size of sample}} = \\frac{X}{n}\n}}.$$\n\n:::{.callout-note}\nThe $\\hat{p}$ symbol for a sample proportion is pronounced \"p hat\".\n:::\n\n\nA <span style=\"color:dodgerblue\">**sampling distribution of proportions**</span> is a distribution of the sample proportions, $\\hat{P}$, computed from many (or all) random samples each size $n$ picked independently from the same  population (with probability $p$ of picking a \"success\").\n\n\n## Question 1\n\n---\n\nWe randomly pick a pool of $20$ people to fill a jury pool from a population where 42% of eligible jurors identify their political party as Independents.  A jury pool is picked that has 8 out of 20 people in the jury pool say they are politically Independent\n\n\n### Question 1a\n\n---\n\nWhat is the value of $p$? \n\n#### Solution to Question 1a\n\n---\n\n\n<br>  \n<br>  \n<br>  \n\n\n\n### Question 1b\n\n---\n\nWhat is the value of $\\hat{p}$? \n\n#### Solution to Question 1b\n\n---\n\n\n<br>  \n<br>  \n<br>  \n\n\n\n### Question 1c\n\n---\n\nWill the value of $\\hat{p}$ change when different jury pools are selected? If not, explain why not. If so, what would you expect the value of $\\hat{p}$ to be? \n\n#### Solution to Question 1c\n\n---\n\n\n<br>  \n<br>  \n<br>  \n\n\n\n### Question 1d\n\n---\n\nWill the value of $p$ change when different jury pools are selected? If not, explain why not. If so, what would you expect the value of $p$ to be? \n\n#### Solution to Question 1d\n\n---\n\n\n<br>  \n<br>  \n<br>  \n\n\n\n### Question 1e\n\n---\n\nLet random variable $X$ denote the number of people in the jury pool that identify politically as Independent. What random variable can we use to model the probabilities of picking different values of $X$?\n\n\n#### Solution to Question 1e\n\n---\n\n\n<br>  \n<br>  \n<br>  \n\n\n\n# Simulating a Sampling Distribution of Proportions\n\n---\n\nBefore investigating the theory, we will first walk through a statistical simulation for constructing a sampling distribution for proportions from many randomly selected samples. Hopefully we can see similarities in this process as with our initial construction of [sampling distributions for means](10-Sampling-Dist-Mean.qmd){target=\"_blank\"}, and these connections will be useful in constructing sampling distributions with statistics. We will compare the results of the simulation with the theory we explore after.\n\n\n## Simulating Jury Selection with `sample()`\n\n---\n\nWe first pick one random sample size $n=20$ from the population $X \\sim \\mbox{Binom}(20, 0.42)$. The code cell below uses the `sample()` function to simulate randomly selecting a pool of 20 jurors from a population where 42% of voters identify as Independents and the remaining 58% of voters do not identify as Independent. \n\n- Note 5 out of the 20 people stored in `jury.pool` identify their political party as Independent.\n\n:::{.callout-tip}\nTip: The command `set.seed(937)` fixes the randomization used each time the `sample()` command is run so the same output is generated every time.\n\n- Feel free to delete the `set.seed()` command to appreciate the variability in random sampling.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# set seed for randomization so results do not change\nset.seed(937)  \n\njury.pool <- sample(c(\"Indep\", \"Not\"),  # each time we select either Indep or Not\n                    size = 20,  #  pick 20 people for the pool\n                    replace = TRUE,  # replace the value each time before resampling\n                    prob = c(0.42,0.58))  # probabilities of success (\"Indep\") and failure (\"Not\")\n\njury.pool  # print results to screen\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Not\"   \"Indep\" \"Indep\" \"Not\"   \"Not\"   \"Indep\" \"Not\"   \"Not\"   \"Not\"  \n[10] \"Not\"   \"Not\"   \"Not\"   \"Indep\" \"Not\"   \"Not\"   \"Not\"   \"Not\"   \"Not\"  \n[19] \"Indep\" \"Not\"  \n```\n:::\n:::\n\n\n## Compute Sample Proportion, $\\hat{P} = \\dfrac{X}{n}$\n\n---\n\nThe command `sum(jury.pool == \"Indep\")` counts how many values in the vector `jury.pool` are equal to the string \"Indep\".\n\n - Based on the output stored in `jury.pool` from the previous code cell, the output $5$ is stored in `x`.\n - Thus, the sample proportion stored in `p.hat` is $\\hat{p} = \\frac{5}{20} = 0.25$.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# out of the 20 values in jury.pool\n# count how many equal the string \"Indep\"\nx <- sum(jury.pool == \"Indep\") \n\nn <- 20  # jury pool is size n=20\np.hat <- x / n  # compute p-hat  \np.hat\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.25\n```\n:::\n:::\n\n\n:::{.callout-tip}\nThe command `mean(jury.pool == \"Indep\")` is a more concise way to calculate a sample proportion. The `mean()` function will both sum the number of \"Indep\" in `jury.pool` and divide by the length of the vector `jury.pool`, resulting in a sample proportion.\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# sample proportion with `mean()`\nmean(jury.pool == \"Indep\") \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.25\n```\n:::\n:::\n\n\n\n## Constructing a Distribution of Sample Proportions\n\n---\n\nTo construct a sampling distribution of proportions, we repeat the two steps above over and over again.\n\n1. Pick a random sample of $n=20$ using the `sample()` function.\n2.  Calculate $\\hat{p}$ using a logical test and either a `sum()` or `mean()` function.\n\nThe for loop in the code cell below repeats the two previous steps 10,000 times and stores each sample proportion in a vector named `samp.prop`. Run the code cell below to generate a possible sampling distribution for proportions. \n\n- There is nothing to edit in the code cell.\n- Do not worry, no output is printed to the screen since the output is being stored in `samp.prop`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamp.prop <- numeric(10000) # creates an empty vector to store results\nn <- 20  # each random jury pool is size n=20\n\n# a for loop that generates 10,000 random samples \nfor (i in 1:10000)\n{\n  temp.pool <- sample(c(\"Indep\", \"Not\"),  # pick jury pool\n                      size = 20,  \n                      replace = TRUE, \n                      prob = c(0.42,0.58))  \n  samp.prop[i] <-sum(temp.pool == \"Indep\")/n  # calculate sample proportion\n}\n```\n:::\n\n\n\nThe previous code cell generated many (10,000) random samples. We did not ensure that *all* possible samples are selected exactly once. Generating all possible random samples requires more intricate code that is time consuming to run. \n\n- For example, if the population of eligible voters is only 100 people, then there would be $\\begin{pmatrix} 100 \\\\ 20 \\end{pmatrix} = 5.4 \\times 10^{20}$ distinct jury pools that could be selected! \n\n:::{.callout-tip}  \nBy relaxing the condition to generate every possible sample exactly once, we can get a very good approximation of the sampling distribution with much simpler code that is easier to read, modify, and run!\n:::\n\nThe code cell below plots a histogram of the sampling distribution of the sample proportion of Independents on a jury pool size $n=20$.\n- Comments are used to help explain `hist` options\n- There is nothing to edit in the code cell.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(samp.prop,  # plot stored sample proportions\n     breaks = 20,  # use 20 breaks\n     xlab = \"Sample Proportion, P-Hat\",  # x-axis label\n     main = \"Sampling Distribution of Proportion of Independents, n=20\",  # main label\n     freq = FALSE,  # plot relative frequencies (density) on y-axis\n     xaxt='n')  # disable default x-axis\n\naxis(1, at=seq(0, 1, 0.05), pos=0)  # customize ticks on x-axis\n\nabline(v = 0.42, col = \"blue\", lwd = 2, lty = 1)  # draws vertical line at p\nabline(v = 5/20, col = \"red\", lwd = 2, lty = 2)  # draws vertical line at p-hat\n```\n\n::: {.cell-output-display}\n![](11-Sampling-Dist-Prop_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n## Question 2 \n\n---\n\nBased on the sampling distribution for the sample proportion of Independents plotted above, answer the following:\n\n- What is significant about the location of the blue vertical line plotted at $p=0.42$ relative to the other sample proportions?\n- What is significant about the location of red vertical line plotted at $\\hat{p}=\\frac{5}{20} = 0.25$ relative to the other sample proportions?\n- What is a \"fair\" amount of representation for Independents on a jury pool of size $n=20$?\n- Based on the values stored in `samp.prop`, what is the probability of randomly selecting a jury pool of $n=20$ that has a sample proportion of Independents that is at most $\\hat{p} = 0.25$? \n  - *Hint: Use a logical test involving `samp.prop` and a `sum()` or `mean()` command.*\n\n\n### Solution to Question 2 \n\n---\n\n<br>  \n<br>  \n<br>  \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# use samp.prop to approximate P( p-hat <= 0.25)\n```\n:::\n\n\n<br>  \n\n\n\n# A Theoretical Approach\n\n---\n\nWhen constructing a sampling distribution for proportions, we noted that the probability of getting a certain number of “successes”, $X$, in a sample size $n$ can be modeled using a binomial distribution. We can make use of properties of binomial distributions to obtain a theoretical model for the sampling distribution of sample proportions. The theory gives another method for describing sampling distributions using formulas as opposed to statistical simulations that require technology.\n\n\n## Question 3\n\n---\n\nLet $X \\sim \\mbox{Binom}(n,p)$, and consider the distribution of sample proportions $\\hat{P} = \\frac{X}{n}$.\n\n### Question 3a\n\n---\n\nUsing [properties of the binomial distribution](07-Common-Discrete-RandVar.qmd#sec-append-binom){target=\"_blank\"}, what are $E(X)$ and $\\mbox{Var}(X)$? Your answers will depend on the parameters $n$ and $p$.\n\n\n\n#### Solution to Question 3a\n\n---\n\n\n<br>  \n<br>  \n<br>  \n\n\n\n### Question 3b\n\n---\n\nLet $\\widehat{P} = \\frac{X}{n}$ denote the distribution of sample proportions.\nUsing formulas from [Question 3a] and [properties of expected value and variance](06-Expected-Value-and-Variance.qmd#sec-prop-exp){target=\"_blank\"}, give formulas for $E( \\widehat{P} )$ and $\\mbox{Var}( \\widehat{P} )$. Your formulas should depend on parameters $n$ and $p$.\n\n#### Solution to Question 3b\n\n---\n\n<br>  \n<br>  \n<br>  \n\n\n\n# Central Limit Theorem for Proportions {#sec-clt-prop}\n\n---\n\nLet $X \\sim \\mbox{Binom}(n,p)$ be a binomial random variable, and let $\\widehat{P} = \\frac{X}{n}$ denote the distribution of sample proportions.\nThen if the sample size $n$ satisfies <span style=\"color:dodgerblue\">**both** $\\mathbf{np \\geq 10}$ and $\\mathbf{n(1-p) \\geq 10}$</span> , the sampling distribution for $\\widehat{P}$ will:\n\n-   Be approximately <span style=\"color:dodgerblue\">**normally distributed**</span>.\n-   Have mean $\\color{dodgerblue}{E(\\hat{P}) = \\mu_{\\widehat{P}} =p}$.\n-   Have <span style=\"color:dodgerblue\">**standard error**</span> $\\color{dodgerblue}{\\mbox{SE}(\\widehat{P}) = \\sigma_{\\hat{P}} =  \\sqrt{\\frac{p(1-p)}{n}}}$.\n  - The standard error measures the variability in sample proportions due to the randomness in sampling.\n\nWe summarize the results of the <span style=\"color:dodgerblue\">**Central Limit Theorem (CLT) for Proportions**</span> more concisely below:\n\n$$\\color{dodgerblue}{\\boxed{ \\widehat{P} \\sim N \\left( \\mu_{\\widehat{P}} , \\sigma_{\\widehat{P}} \\right) = N \\left( p  , \\sqrt{\\frac{p(1-p)}{n}} \\right) \\qquad \\mbox{ as long as both } np \\geq 10 \\mbox{ and } n(1-p) \\geq 10.}}$$\n\n\n:::{.callout-note}\nRandom variable $X$ is a discrete random variable. Using the expressions for $E(X)$ and $\\mbox{Var}(X)$ in [Question 3a], we can approximate discrete $X \\sim \\mbox{Binom}(n, p)$ with continuous $N(np, \\sqrt{np(1-p)})$. The CLT for proportions essentially is stating this in terms of sample proportions $\\widehat{P}$ instead of the counts $X$.\n:::\n\n\n## Question 4\n\n---\n\nUse the CLT for proportions to describe the sampling distribution for the proportion of Independents on a jury pool of $n=20$ people. As with earlier, assume 42% of the population of eligible jurors identify their political party as Independent.\n\n### Solution to Question 4\n\n---\n\n<br>  \n<br>  \n<br>  \n\n\n## Question 5\n\n---\n\n\nBased on your answer in [Question 4], what is the probability of randomly picking a pool of 20 jurors that consists of at most 25% that identify politically as Independent. \n\n:::{.calllout-tip}\nHint: Use the `pnorm()` function to help!\n:::\n\n### Solution to Question 5\n\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# use CLT and pnorm()\n```\n:::\n\n\n\n## Question 6\n\n---\n\nIn [Question 2] and [Question 5] we use two different methods to calculate $P( \\hat{P} \\leq 0.25)$, the probability of picking a jury pool of 20 people that has at most 25% that identify politically as Independent:\n\n- [Question 2] uses a simulation to approximate the sampling distribution for the proportion of Independent.\n- [Question 5] uses the CLT to theoretically model the sampling distribution.\n\nCompare each of the values you obtained for $P( \\hat{P} \\leq 0.25)$ in [Question 2] and [Question 5]. Which do you believe is more accurate and why?\n\n### Solution to Question 6\n\n---\n\n<br>  \n<br>  \n<br>  \n\n\n\n\n# How Large Does $n$ Need to Be?\n\n---\n\nIn the jury pool example, we have $n=20$, $p=0.42$, and thus $np = 8.4 < 10$. Our sample is *not* seemingly large enough for the CLT according to the conditions stated for proportions above. However, the $np \\geq 10$ and $n(1-p) \\leq 10$ conditions are more like *general guidelines*. We can check how consistent the results of the sampling distribution simulation (results of for loop stored in `samp.prop`) are with the CLT:\n\n- The code cell below checks how closely our simulation matches the result $\\mu_{\\widehat{P}} = E(\\widehat{P}) = p=0.42$.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(samp.prop)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.42013\n```\n:::\n:::\n\n\n- The code cell below checks how closely our simulation matches the result $\\sigma_{\\widehat{P}} = \\mbox{SE}(\\widehat{P}) = \\sqrt{\\frac{p(1-p)}{n}}=0.1104$.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsd(samp.prop)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1101817\n```\n:::\n:::\n\n\n- The code cell below uses a **quantile-quantile plot** to compare the distribution of sample proportions from our simulation to the standard normal distribution.\n  \n  - <span style=\"color:mediumseagreen\">**The sampling distribution distribution is fairly close to the line in the qq-plot!**</span>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqqnorm(samp.prop)\nqqline(samp.prop)\n```\n\n::: {.cell-output-display}\n![](11-Sampling-Dist-Prop_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n- We see <span style=\"color:mediumseagreen\">**all three results regarding the center, spread, and shape of the sampling distribution of sample proportions are reasonably accurate**</span> in the jury pool example even though the conditions of the \"rule\" are not quite satisfied.\n\n\nIn the statement of the Central Limit Theorem for proportions, we state the theorem applies as long as <span style=\"color:dodgerblue\">**both $np \\geq 10$ and $n(1-p) \\geq 10$**</span>. \n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](11-Sampling-Dist-Prop_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n- The $np \\geq 10$ and $n(1-p) \\geq 10$ criterion is <span style=\"color:tomato\">not a set rule</span> that *must* be satisfied.\n  - If the conditions are met, then a normal distribution is a good approximation.\n  - If the conditions are not met, then a normal distribution *may* still be a good approximation. Compare distributions!\n  \n- <span style=\"color:dodgerblue\">**Whether a normal distribution is a good approximation depends on both the sample size $n$ and the proportion $p$.**</span>\n  - The larger $n$ is, the better the more normal ($p$ closer to 1 or 0 can be okay).\n  - The closer $p$ is to $0.5$, the more normal (smaller $n$ can be okay).\n  \n- <span style=\"color:dodgerblue\">**It is always a good to compare/check numerical and theoretical results to be sure!**</span>\n\nIf our sample is not large enough (either $np < 10$ or $n(1-p) < 10$) then sampling distribution of the sample proportions:\n\n- <span style=\"color:mediumseagreen\">**Will still satisfy $E(\\widehat{P}) = p$.**</span>\n- <span style=\"color:mediumseagreen\">**Will still have standard error $\\mbox{SE}( \\widehat{P}) = \\sqrt{\\frac{p(1-p)}{n}}$.**</span>\n- <span style=\"color:tomato\">**But may NOT be normally distributed.**</span>\n\n\n# Comparing Binomial and Normal Distributions\n\n--- \n\nWhen constructing a sampling distribution of sample proportions, we approximate the distribution of sample proportions with a continuous distribution, namely a normal distribution. However, the possible sample proportions we can get from a sample size $n$ are not continuous.  The possible sample proportions are a discrete set.\n\n-   In the jury example, we have $n=20$ and $X = \\left\\{ 0, 1, \\ldots , 19, 20 \\right\\}$.\n-   Thus, the possible sample proportions are $\\hat{p} = \\left\\{ 0, 0.05, 0.10, \\ldots , 0.95, 1 \\right\\}$.\n-   However, in [Question 5] we approximate $\\hat{P} \\sim N( 0.42, 0.1104)$ with a continuous, normal distribution.\n- *Note: We could equivalently use $N \\big( 0.42, \\sqrt{(20)(0.42)(0.58) \\big)}$ to approximate $X \\sim (20, 0.42)$ and have the same issue.*\n-   We can see this discrepancy between discrete data and continuous approximation in the step-like pattern in the previous qq-plots.\n\n:::{.callout-warning}\nSince CLT for Proportions uses a continuous (normal) distribution to approximate a discrete (binomial) distribution, any results obtained using CLT will be approximations, not exact.\n:::\n\n\n## Question 7\n\n---\n\nConsider the same jury pool example where we randomly select a jury from a population where 42% of eligible jurors identify their political party as Independent. Let $X$ denote the number of Independents on jury pool size $n=20$. Use a binomial distribution to calculate the $P(X \\leq 5)$, the probability that at most 5 out of 20 identify politically as Independents.\n\n\n### Solution to Question 7\n\n---\n\n<br>  \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# use a binomial function to answer question 7\n```\n:::\n\n\n\n# Comparing Binomial Distribution to Approximation from the CLT\n\n---\n\nIn the jury pool example, the discrete binomial distribution $X \\sim \\mbox{Binom}(20, 0.42)$ is used to identify the probability of getting exactly $X$ Independents in a jury of $n=20$. From the CLT for proportions, we have $\\color{dodgerblue}{\\widehat{P} \\sim N \\left(p , \\sqrt{\\frac{p(1-p)}{n}} \\right) = N(0.42, 0.1104)}$, which is also equivalent to the approximation $\\color{dodgerblue}{X \\sim N \\left( np , \\sqrt{np(1-p)} \\right) = N(8.4, 2.2073)}$. The figure below illustrates and compares how we can use different distributions to estimate the same probabilities.\n\n- The precise, binomial distribution $X \\sim \\mbox{Binom}(20, 0.42)$ is plotted as a histogram.\n  - In [Question 7], we used $X \\sim \\mbox{Binom}(20, 0.42)$ to calculate $P(X \\leq 5) = 0.0922$. \n  - The <span style=\"color:dodgerblue\">normal approximation for $X$ is $N \\big( np, \\sqrt{np(1-p)} \\big) = N (8.4, 2.2073)$</span> and plotted in blue.\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n:::\n\n::: {.cell-output-display}\n![](11-Sampling-Dist-Prop_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n-   In [Question 5], we used the CLT for proportions to approximate $P(\\widehat{P} \\leq 0.25) \\approx P( X \\leq 5) \\approx 0.0617$.\n  -   The region corresponding to the approximation $\\color{tomato}{P( X \\leq 5) \\approx 0.0617}$ is shaded in red.\n  - This is the area to right of $X=5$ below graph of the normal approximation for $X$ given by $N (8.4, 2.2073)$. \n-   Comparing areas in the figure below, we see the area shaded in red is smaller than the actual area of the rectangles over $X=0,1,2,3,4, \\mbox{ and } 5$.\n    -   Using a normal distribution to approximate areas below a binomial distribution will result in an <span style=\"color:dodgerblue\">**underestimate**</span>.\n        \n        \n\n- <span style=\"color:dodgerblue\">**Using a normal distribution to approximate the binomial distribution**</span>, we have $\\color{dodgerblue}{\\widehat{P} \\sim N(0.42, 0.1104)}$.\n  - In [Question 5], we used the CLT for proportions to calculate $\\color{dodgerblue}{P(\\widehat{P} \\leq 0.25) = P( X \\leq 5) \\approx 0.0617}$.\n  - Comparing areas in the figure below, we see the area shaded in red is smaller than the actual area of the rectangles over $X=0,1,2,3,4, \\mbox{ and } 5$.\n  - Using a normal distribution to approximate $P(\\widehat{P} \\leq 0.25)$ results in an <span style=\"color:dodgerblue\">**underestimate**</span>.\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](11-Sampling-Dist-Prop_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\n# Continuity Correction for Discrete Random Variables {#sec-cont-corr}\n\n---\n\nIn the previous plot, we note using a normal distribution to approximate a binomial distribution results in an underestimate since we miss capturing some of the rectangular area below the binomial distribution.  We can improve the estimates we obtain using a normal distribution by including some additional area using a <font color=\"dodgerblue\">**continuity correction**</font> as follows. \n\nTo more accurately calculate $P( a \\leq X \\leq b)$ where $a < b$ are integers, then we apply the following correction:\n\n-   Shift the lower cutoff $X=a$ half a unit further to the left, to $X = a-0.5$.\n-   Shift the upper cutoff $X=b$ half a unit further to the right, to $X = b+0.5$.\n\nIf we use the CLT for proportions to approximate the distribution of sample proportions as\n$\\widehat{P} \\sim N \\left( p, \\sqrt{\\frac{p(1-p)}{n}} \\right)$, then using proportions, the two corrected cutoffs will be:\n\n- <span style=\"color:dodgerblue\">**Corrected lower sample proportion is $\\hat{p}^*_{\\rm lower} = \\dfrac{a-0.5}{n}$.**</span>\n- <span style=\"color:dodgerblue\">**Corrected upper sample proportion is $\\hat{p}^*_{\\rm upper} = \\dfrac{b+0.5}{n}$.**</span>\n\nApplying a continuity correction to sample proportions, we have an improved estimate:\n\n$$\\color{dodgerblue}{P( a \\leq X \\leq b) \\approx  P \\left( \\frac{a-0.5}{n} < \\widehat{P} < \\frac{b+0.5}{n} \\right)}.$$\n\n## Plot of Exact Area Under Binomial Distribution\n\n---\n\nWe can use the binomial distribution $X \\sim \\mbox{Binom}(n, p)$ to compute the exact value of $P(a \\leq X \\leq b)$. We add up the areas of each of the shaded rectangles.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](11-Sampling-Dist-Prop_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n## Plot of Normal Approximation Without a Continuity Correction\n\n---\n\nIf we use the CLT for proportions we get $\\widehat{P} \\sim N \\left( p, \\sqrt{\\frac{p(1-p)}{n}} \\right)$. Using the CLT for proportions without applying a continuity correction, we get an <span style=\"color:tomato\">**underestimate $P \\left( \\frac{a}{n} \\leq \\widehat{P} \\leq \\frac{b}{n} \\right) \\approx$ that is shaded in red below**</span>. Notice there is gray shaded area under the binomial distribution that is missing from the shaded region under the normal distribution.\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](11-Sampling-Dist-Prop_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n\n## Plot of Normal Approximation With a Continuity Correction\n\n---\n\nUsing the CLT for proportions along with a continuity correction, we get\nan <span style=\"color:dodgerblue\">**improved estimate\n$P \\left( \\frac{a-0.5}{n} \\leq \\widehat{P} \\leq \\frac{b+0.5}{n} \\right)$**</span> which is the <span style=\"color:tomato\">red region</span> plus the <span style=\"color:dodgerblue\">additional area in the two blue strips</span>. The sum of the red and blue areas under the normal distribution is a much better approximation for the exact area under the binomial distribution.\n\n-   There is a little extra area beneath the normal curve that is not included in any of the rectangular bars under the binomial distribution.\n-   The extra area under the normal distribution approximately balances out the remaining gray rectangular areas missed above the normal distribution.\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](11-Sampling-Dist-Prop_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n## Question 8\n\n---\n\nUse the CLT for proportions along with a continuity correction to approximate the probability of randomly selecting a jury pool of $n=20$ people that has at most 5 people that identify politically as Independent. Assume that 42% of all eligible jurors identify their political party as Independent. \n\n- *Note: Although our sample size does not technically satisfy the conditions for the CLT for proportions, we verified the results hold in this example, so we may go ahead and use the CLT.*\n- *Hint: There is no correction needed for a the lower cutoff since there is no lower cutoff. You only need to apply the correction to get a new upper cutoff.*\n\n\n### Solution to Question 8\n\n---\n\n\n<br>  \n<br>  \n<br> \n\n\n## Question 9\n\n---\n\nCensus Bureau data for 2017 shows nearly half (48 percent) of residents in the United States' five largest cities now speak a language other than English at home^[Karen Zeigler and Steven A. Camarota [*Almost Half Speak a Foreign Language in America's Largest Cities*](https://cis.org/Report/Almost-Half-Speak-Foreign-Language-Americas-Largest-Cities#1). Center for Immigration Studies, 2018 Sep 29.]. If a sample of 150 people is selected at random from the five largest cities in the US, what is the probability that between 44% and 48% of people in the sample speak a language other than English at home?\n\n\n### Question 9a\n\n---\n\nIs $n$ large enough to use the CLT? Explain why or why not?\n\n#### Solution to Question 9a\n\n---\n\n<br>  \n<br>  \n<br> \n\n\n### Question 9b\n\n---\n\nUsing the CLT for a proportion, find the $z$-scores of the proportions $0.44$ and $0.48$.\n\n#### Solution to Question 9b\n\n---\n\n<br>  \n<br>  \n<br> \n\n\n### Question 9c\n\n---\n\nUsing the $z$-scores from [Question 9b], what is the probability that between 44% and 48% (out of the random sample of 150 people) speak a language other than English at home?\n\n#### Solution to Question 9c\n\n---\n\n<br>  \n<br>  \n<br> \n\n\n\n### Question 9d\n\n---\n\nUsing the CLT for a proportion **along with a continuity correction**, give updated $z$-scores after applying a continuity correction to both endpoints of the interval.\n\n\n#### Solution to Question 9d\n\n---\n\n<br>  \n<br>  \n<br>  \n\n\n\n\n### Question 9e\n\n---\n\n\nUsing the $z$-scores obtained from the continuity correction in [Question 9d], what is the probability that between 44% and 48% (out of the random sample of 150 people) speak a language other than English at home?\n\n\n#### Solution to Question 9e\n\n---\n\n<br>  \n<br>  \n<br>  \n\n\n\n\n## Question 10\n\n---\n\nIn [Question 9] we calculated $P\\left( 0.44 \\leq \\widehat{P} \\leq 0.48 \\right)$ using a normal distribution (using the CLT for proportions). We could equivalently rewrite this probability in terms of the discrete random variable $X \\sim \\mbox{Binom}(150,0.48)$ as $P( 66 \\leq X \\leq 72$).\n\n### Question 10a\n\n---\n\nUsing a binomial distribution, calculate the exact value of $P( 66 \\leq X \\leq 72$).\n\n#### Solution to Question 10a\n\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# use binomial functions in R to solve 10a\n```\n:::\n\n\n\n<br>  \n<br>  \n<br>  \n\n\n\n\n::: {.cell}\n\n:::\n\n\n### Question 10b\n\n---\n\nCompare approximations from [Question 9c] and [Question 9e] with the exact calculation in [Question 10a].\nComment on whether or not the continuity correction improved the approximation or not.\n\n\n#### Solution to Question 10b\n\n---\n\n<br>  \n<br>  \n<br>  \n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n---\n\n![Creative Commons License](https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png) <nbsp>\n\n*Statistical Methods: Exploring the Uncertain* by [Adam Spiegler](https://github.com/CU-Denver-MathStats-OER/Statistical-Theory) is licensed under a [Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License](http://creativecommons.org/licenses/by-nc-sa/4.0/).",
    "supporting": [
      "11-Sampling-Dist-Prop_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}