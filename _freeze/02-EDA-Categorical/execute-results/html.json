{
  "hash": "cb9fa4711d1d130df0452a08ce78c0db",
  "result": {
    "markdown": "---\ntitle: \"1.2: Exploring Categorical Data\"\n#author: 'Adam Spiegler, University of Colorado Denver'\noutput:\n  html_document:\n#    toc: yes\n#    toc_depth: 1\n#    theme: cerulean\n#jupyter:\n#  kernelspec:\n#    display_name: R\n#    language: R\n#    name: ir\n#output:\n#    ipynbdocument::ipynb_document\n---\n\n\n[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://githubtocolab.com/CU-Denver-MathStats-OER/Statistical-Theory/blob/main/Chap1/02-EDA-Categorical.ipynb){target=\"_blank\"} <nbsp>\n\n\nAdditional Reading:\n\n- See [Overview of Plotting Data in R](Overview-of-Plots.qmd){target=\"_blank\"} for further reading and examples about plotting in R.\n- See [Fundamentals of Working with Data](Intro-to-Vectors-Dataframes.qmd){target=\"_blank\"} for more information about data types and structures in R.\n- The [R Graph Gallery](https://r-graph-gallery.com/){target=\"_blank\"} has examples of many other types of graphs.\n\n\n# An Overview of Exploratory Data Analysis\n\n---\n\n<span style=\"color:dodgerblue\">**Exploratory data analysis**</span>, or <span style=\"color:dodgerblue\">**EDA**</span> for short, can be thought of as a cycle:\n\n- Generate questions about our data.\n- Search for answers by visualizing, transforming, and modeling our data.\n- Use what we learn to refine your questions and/or generate new questions.\n\nThe main goal of EDA is to develop an understanding of your data. When we ask a question, the question focuses our attention on a specific part of the data set and helps us decide which graphs, models, or transformations to make.\n\n\n# Loading the `dplyr` Package {#sec-dplyr}\n\n---\n\nThe `dplyr` package is perhaps one of the most useful R packages for <span style=\"color:dodgerblue\">**data wrangling**</span> and EDA. Data wrangling is generally the cleaning, reorganizing, and transforming data so it can be more easily analyzed. `dplyr` also contains data sets that we can use to practice our wrangling and visualization skills. In this lab, we will work with the data set called `storms`.\n\n- See [official dplyr documentation](https://dplyr.tidyverse.org/articles/dplyr.html){target=\"_blank\"} for a comprehensive tutorial.\n- **Run the code cell below to load the `dplyr` package.**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# loads dplyr package\nlibrary(dplyr)\n```\n:::\n\n\n## Finding Help Documentation\n\n---\n\n- The code cell below opens a glossary tab of all (most?) functions and data in the package `dplyr`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# open glossary of dplyr functions\nhelp(package = \"dplyr\")\n```\n:::\n\n\n- The code cell below opens a help tab with information about the `storms` data set.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# opens help tab with info about storms data set\n?storms\n```\n:::\n\n\n# The Structure of Data\n\n---\n\n<span style=\"color:dodgerblue\">**Data frames**</span> are two-dimensional data objects and are the **fundamental** data structure used by most of R's libraries of functions and data sets.\n\n-   Tabular data is <span style=\"color:dodgerblue\">**tidy**</span> if each row corresponds to a different observation and each column corresponds to a different variable.\n\nEach column of a data frame is a <span style=\"color:dodgerblue\">**variable**</span> (stored as a **vector**) of possibly different data types.\n\n- If a variable is measured or counted by a number, it is called a <span style=\"color:dodgerblue\">**quantitative**</span> or <span style=\"color:dodgerblue\">**numerical**</span> variable.\n  - Quantitative variables may be <span style=\"color:dodgerblue\">**discrete**</span> (integers) or <span style=\"color:dodgerblue\">**continuous**</span> (decimals).\n- If a variable groups observations into different categories or rankings, it is a <span style=\"color:dodgerblue\">**qualitative**</span> or <span style=\"color:dodgerblue\">**categorical**</span> variable.\n  - The different categories of a qualitative variable are called <span style=\"color:dodgerblue\">**levels**</span> or <span style=\"color:dodgerblue\">**classes**</span>.\n    - Levels are typically labeled with descriptive character strings or integers.\n    - Levels may or may not have an ordering.\n  - An <span style=\"color:dodgerblue\">**ordinal variable**</span> is when the levels of a categorical variable do have a specified order.\n\n# Exploring Our Data\n\n---\n\nBelow are some common functions used to get a first introduction to our data:\n\n-   `summary(df)` gives numerical summary of all variables in data frame with generic name `df`.\n-   `glimpse(df)` gives a glimpse of the data frame `df`.\n-   `str(df)` summarizes the structure of all variables in data frame `df`\n-   `head(df)` view first 6 rows in data frame.\n-   `tail(df)` view last 6 rows in data frame.\n-   `View(df)` to view the full data frame.\n  - <span style=\"color:tomato\">It typically is not recommended to include a `View()` command in your work</span> since that opens the entire data set.\n  - The goal of EDA is to provide nice summaries of a data set so we do not need to look at all the raw data!\n\n\n## Question 1\n\n---\n\nLet's get to know the `storms` data set. Using some (or all) of the commands above, answer the following questions:\n\n- How many observations are in data set `storms`? \n- How many variables are `storms`?\n  - Which variables are quantitative and which are categorical? \n  - Which categorical variables have a ranking? Which do not?\n- Hint: Avoid using the `View()` function. Instead, use `head()` or `tail()` if you want to get a sense of what the raw data looks like.\n  \n<span style=\"color:dodgerblue\">**Experiment with some of the functions in the code cell below to answer the questions. Then type your answer in the space below.**</span>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(storms)  # summary of each variable in storms\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     name                year          month             day       \n Length:19066       Min.   :1975   Min.   : 1.000   Min.   : 1.00  \n Class :character   1st Qu.:1993   1st Qu.: 8.000   1st Qu.: 8.00  \n Mode  :character   Median :2004   Median : 9.000   Median :16.00  \n                    Mean   :2002   Mean   : 8.699   Mean   :15.78  \n                    3rd Qu.:2012   3rd Qu.: 9.000   3rd Qu.:24.00  \n                    Max.   :2021   Max.   :12.000   Max.   :31.00  \n                                                                   \n      hour             lat             long                         status    \n Min.   : 0.000   Min.   : 7.00   Min.   :-109.30   tropical storm     :6684  \n 1st Qu.: 5.000   1st Qu.:18.40   1st Qu.: -78.70   hurricane          :4684  \n Median :12.000   Median :26.60   Median : -62.25   tropical depression:3525  \n Mean   : 9.094   Mean   :26.99   Mean   : -61.52   extratropical      :2068  \n 3rd Qu.:18.000   3rd Qu.:33.70   3rd Qu.: -45.60   other low          :1405  \n Max.   :23.000   Max.   :70.70   Max.   :  13.50   subtropical storm  : 292  \n                                                    (Other)            : 408  \n    category          wind           pressure      tropicalstorm_force_diameter\n Min.   :1.000   Min.   : 10.00   Min.   : 882.0   Min.   :   0.0              \n 1st Qu.:1.000   1st Qu.: 30.00   1st Qu.: 987.0   1st Qu.:   0.0              \n Median :1.000   Median : 45.00   Median :1000.0   Median : 110.0              \n Mean   :1.898   Mean   : 50.02   Mean   : 993.6   Mean   : 146.3              \n 3rd Qu.:3.000   3rd Qu.: 65.00   3rd Qu.:1007.0   3rd Qu.: 220.0              \n Max.   :5.000   Max.   :165.00   Max.   :1024.0   Max.   :1440.0              \n NA's   :14382                                     NA's   :9512                \n hurricane_force_diameter\n Min.   :  0.00          \n 1st Qu.:  0.00          \n Median :  0.00          \n Mean   : 14.81          \n 3rd Qu.:  0.00          \n Max.   :300.00          \n NA's   :9512            \n```\n:::\n\n```{.r .cell-code}\n#head(storms)  # prints first 6 rows to screen\n#tail(storms)  # prints last 6 rows to screen\n#glimpse(storms)  # gives a glimpse of the data set\n#str(storms)   # summary of data structure\n```\n:::\n\n\n\n### Solution to Question 1\n\n---\n\n<br>  \n<br>  \n<br>  \n\n\n## Question 2:\n\n---\n\nWhat additional information would you like to know about the `storms` data set that you were unable to find? What questions do you have about the data? In particular, what data is missing and why?\n\n### Solution to Question 2:\n\n---\n\n<br>  \n<br>  \n<br>  \n\n\n\n# Data Types\n\n---\n\nR has 6 basic [data types](https://cran.r-project.org/doc/manuals/r-release/R-lang.html#Basic-types){target=\"_blank\"}:\n\n1.  <span style=\"color:dodgerblue\">**character**</span>: collections of characters. E.g., `\"a\"`, `\"hello world!\"`\n2.  <span style=\"color:dodgerblue\">**double**</span>: decimal numbers. e.g., `1.2`, `1.0`\n3.  <span style=\"color:dodgerblue\">**integer**</span>: whole numbers. In R, you must add `L` to the end of a number to specify it as an integer. E.g., `1L` is an integer but `1` is a double.\n4.  <span style=\"color:dodgerblue\">**logical**</span>: Boolean values, `TRUE` and `FALSE`\n5.  <span style=\"color:dodgerblue\">**complex**</span>: complex numbers. E.g., `1+3i`\n6.  <span style=\"color:dodgerblue\">**raw**</span>: a type to hold raw bytes.\n\nSee the Appendix for an [Fundamentals of Working with Data](Intro-to-Vectors-Dataframes.qmd) for more information.\n\n## Checking Data Types Using `typeof()`\n\n---\n\n-   The `typeof()` function returns the R internal type or storage mode of any object.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntypeof(1.0)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"double\"\n```\n:::\n\n```{.r .cell-code}\ntypeof(2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"double\"\n```\n:::\n\n```{.r .cell-code}\ntypeof(3L)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"integer\"\n```\n:::\n\n```{.r .cell-code}\ntypeof(\"hello\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"character\"\n```\n:::\n\n```{.r .cell-code}\ntypeof(TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"logical\"\n```\n:::\n\n```{.r .cell-code}\ntypeof(storms$status)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"integer\"\n```\n:::\n\n```{.r .cell-code}\ntypeof(storms$year)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"double\"\n```\n:::\n\n```{.r .cell-code}\ntypeof(storms$name)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"character\"\n```\n:::\n:::\n\n\n\n## Extracting a Variable By Name with `$`\n\n---\n\nIn the command `typeof(storms$status)`, notice we refer to just the `status` variable of the `storms` data frame. <span style=\"color:dodgerblue\">**A variable from a data frame may be extracted using `$` and then specifying the name of the desired variable**.</span>\n\n- First indicate the name of the data frame, `storms`.\n- Followed by a dollar sign `$`.\n- Then indicate the name of the variable, for example `wind`.\n- The `storms$wind` is a vector that contains the wind speed of each storm.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nis.vector(storms)  # storms is not a vector\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n\n```{.r .cell-code}\nis.data.frame(storms)  # storms is a data frame\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n\n```{.r .cell-code}\nis.data.frame(storms$wind)  # status is not a data frame\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n\n```{.r .cell-code}\nis.vector(storms$wind)  # status is a vector\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n:::\n\n\n## Investigating Data Types with `is.numeric()`\n\n---\n\n-   The `is.numeric(x)` function tests whether or not an object `x` is numeric.\n-   The `is.character(x)` function tests whether `x` is a character or not.\n-   The `is.factor(x)` function tests whether `x` is a factor or not.\n  - <span style=\"color:dodgerblue\">**Note: Categorical data is typically stored as a `factor` in R.**</span>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nis.numeric(storms$year)  # year is numeric\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n\n```{.r .cell-code}\nis.numeric(storms$category)  # category is also numeric\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n\n```{.r .cell-code}\nis.numeric(storms$name)  # name is not numeric\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n\n```{.r .cell-code}\nis.character(storms$name)  # name is character string\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nis.numeric(storms$status)  # status is not numeric\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n\n```{.r .cell-code}\nis.character(storms$status)  # status is not a character\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n\n```{.r .cell-code}\nis.factor(storms$status)  # status is a factor which is categorical\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n:::\n\n\n## Converting Decimals to Integers \n\n---\n\nFrom the summary of the `storms` data set we first found above, we see that the variables `year` and `month` are being stored as `double`. These variables actually are integer values.\n\nWe can convert another variable of one format into another format using `as.[new_datatype]()`\n\n-   For example, to convert to year to `integer`, we use `as.integer(storms$year)`.\n-   To convert a data type to character, we can use `as.character(x)`.\n-   To convert to a decimal (`double`), we can use `as.numeric(x)`\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntypeof(storms$year)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"double\"\n```\n:::\n\n```{.r .cell-code}\ntypeof(storms$month)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"double\"\n```\n:::\n\n```{.r .cell-code}\nstorms$year <- as.integer(storms$year)\nstorms$month <- as.integer(storms$month)\ntypeof(storms$year)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"integer\"\n```\n:::\n\n```{.r .cell-code}\ntypeof(storms$month)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"integer\"\n```\n:::\n:::\n\n\n\n## Converting to Categorical Data with `factor()`\n\n---\n\nSometimes we think a variable is one data type, but it is actually being stored (and thus interpreted by R) as a different data type. One common issue is categorical data is stored as characters or integers. We would like observations with the same values to be group together.\n\n- The `status` variable in `storms` is being properly stored as a `factor`.\n- The `category` variable in `storms` is being stored as a `numeric` since the classes are integers.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(storms$category)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n  1.000   1.000   1.000   1.898   3.000   5.000   14382 \n```\n:::\n:::\n\n\n\nThe summary of `category` computes statistics such as mean and median. <span style=\"color:dodgerblue\">**Typically with categorical data, we prefer to count how many observations are in each class of the variable.**</span>\n\n- In the code cell below, we convert `category` to a factor, and then observe the resulting summary.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstorms$category <- factor(storms$category)\nsummary(storms$category)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    1     2     3     4     5  NA's \n 2478   973   579   539   115 14382 \n```\n:::\n:::\n\n\n  \n\n## Assignment of New Objects\n\n---\n\nNotice in the code cell above, we replace the original integers in the `category` column with a integers that are now stored as different levels of a categorical variable.\n\n- To store a data structure in the computer's memory we must assign it a name.\n  - In this case, we choose to give the variable the same name, an therefore overwrite the original `category` column.\n- <span style=\"color:dodgerblue\">**Data structures can be stored using the assignment operator `<-`.**</span>\n\n\n\n# Frequency and Relative Frequency Tables\n\n---\n\n- `table(x)` creates a frequency table for categorical variable `x`.\n- `table(x, y)` creates a two-way (or contingency) table for two categorical variables `x` and `y`\n- `prop.table([table])` creates a relative frequency table relative to the grand total.\n  -  The input of `prop.table()` must be a table.\n  - `prop.table([table], 1)` creates a relative frequency table relative to total in each row.\n  - `prop.table([table], 2)` creates a relative frequency table relative to total in each column.\n\n\n## Question 3\n\n---\n\na. Which month over the period from 1975-2021 had the greatest number of **subtropical** storms? Which table did you use to help answer your question?\n\nb. Which month over the period from 1975-2021 had the greatest proportion of **subtropical** storms? Which table did you use to help answer your question?\n\n\n**Run each of the four code cells below, and after interpreting the output of each, answer the questions in the space below.**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy.table <- table(storms$month, storms$status)  # gives counts\nmy.table\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    \n     disturbance extratropical hurricane other low subtropical depression\n  1            0            29         5         5                      0\n  4            0            40         0         0                      4\n  5            0            18         0        49                      5\n  6           13           130        18        82                     35\n  7           45           135       202       175                     11\n  8           25           275      1038       317                     36\n  9           41           732      2380       446                     34\n  10          14           520       799       219                     22\n  11           8           175       209        81                      4\n  12           0            14        33        31                      0\n    \n     subtropical storm tropical depression tropical storm tropical wave\n  1                  6                   2             23             0\n  4                  3                   1             18             0\n  5                 20                  49             60             0\n  6                 12                 213            276             0\n  7                  6                 397            625             7\n  8                 23                 975           1696            55\n  9                 72                1315           2448            41\n  10                66                 413           1024             0\n  11                42                 139            443             8\n  12                42                  21             71             0\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprop.grand <- prop.table(my.table)  # gives proportions relative to grand total\nround(prop.grand, 4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    \n     disturbance extratropical hurricane other low subtropical depression\n  1       0.0000        0.0015    0.0003    0.0003                 0.0000\n  4       0.0000        0.0021    0.0000    0.0000                 0.0002\n  5       0.0000        0.0009    0.0000    0.0026                 0.0003\n  6       0.0007        0.0068    0.0009    0.0043                 0.0018\n  7       0.0024        0.0071    0.0106    0.0092                 0.0006\n  8       0.0013        0.0144    0.0544    0.0166                 0.0019\n  9       0.0022        0.0384    0.1248    0.0234                 0.0018\n  10      0.0007        0.0273    0.0419    0.0115                 0.0012\n  11      0.0004        0.0092    0.0110    0.0042                 0.0002\n  12      0.0000        0.0007    0.0017    0.0016                 0.0000\n    \n     subtropical storm tropical depression tropical storm tropical wave\n  1             0.0003              0.0001         0.0012        0.0000\n  4             0.0002              0.0001         0.0009        0.0000\n  5             0.0010              0.0026         0.0031        0.0000\n  6             0.0006              0.0112         0.0145        0.0000\n  7             0.0003              0.0208         0.0328        0.0004\n  8             0.0012              0.0511         0.0890        0.0029\n  9             0.0038              0.0690         0.1284        0.0022\n  10            0.0035              0.0217         0.0537        0.0000\n  11            0.0022              0.0073         0.0232        0.0004\n  12            0.0022              0.0011         0.0037        0.0000\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprop.row <- prop.table(my.table, 1)  # gives proportions relative to row totals\nround(prop.row, 4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    \n     disturbance extratropical hurricane other low subtropical depression\n  1       0.0000        0.4143    0.0714    0.0714                 0.0000\n  4       0.0000        0.6061    0.0000    0.0000                 0.0606\n  5       0.0000        0.0896    0.0000    0.2438                 0.0249\n  6       0.0167        0.1669    0.0231    0.1053                 0.0449\n  7       0.0281        0.0842    0.1260    0.1092                 0.0069\n  8       0.0056        0.0619    0.2338    0.0714                 0.0081\n  9       0.0055        0.0975    0.3170    0.0594                 0.0045\n  10      0.0045        0.1690    0.2597    0.0712                 0.0071\n  11      0.0072        0.1578    0.1885    0.0730                 0.0036\n  12      0.0000        0.0660    0.1557    0.1462                 0.0000\n    \n     subtropical storm tropical depression tropical storm tropical wave\n  1             0.0857              0.0286         0.3286        0.0000\n  4             0.0455              0.0152         0.2727        0.0000\n  5             0.0995              0.2438         0.2985        0.0000\n  6             0.0154              0.2734         0.3543        0.0000\n  7             0.0037              0.2477         0.3899        0.0044\n  8             0.0052              0.2196         0.3820        0.0124\n  9             0.0096              0.1751         0.3260        0.0055\n  10            0.0214              0.1342         0.3328        0.0000\n  11            0.0379              0.1253         0.3995        0.0072\n  12            0.1981              0.0991         0.3349        0.0000\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprop.col <- prop.table(my.table, 2)  # gives proportions relative to column totals\nround(prop.col, 4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    \n     disturbance extratropical hurricane other low subtropical depression\n  1       0.0000        0.0140    0.0011    0.0036                 0.0000\n  4       0.0000        0.0193    0.0000    0.0000                 0.0265\n  5       0.0000        0.0087    0.0000    0.0349                 0.0331\n  6       0.0890        0.0629    0.0038    0.0584                 0.2318\n  7       0.3082        0.0653    0.0431    0.1246                 0.0728\n  8       0.1712        0.1330    0.2216    0.2256                 0.2384\n  9       0.2808        0.3540    0.5081    0.3174                 0.2252\n  10      0.0959        0.2515    0.1706    0.1559                 0.1457\n  11      0.0548        0.0846    0.0446    0.0577                 0.0265\n  12      0.0000        0.0068    0.0070    0.0221                 0.0000\n    \n     subtropical storm tropical depression tropical storm tropical wave\n  1             0.0205              0.0006         0.0034        0.0000\n  4             0.0103              0.0003         0.0027        0.0000\n  5             0.0685              0.0139         0.0090        0.0000\n  6             0.0411              0.0604         0.0413        0.0000\n  7             0.0205              0.1126         0.0935        0.0631\n  8             0.0788              0.2766         0.2537        0.4955\n  9             0.2466              0.3730         0.3662        0.3694\n  10            0.2260              0.1172         0.1532        0.0000\n  11            0.1438              0.0394         0.0663        0.0721\n  12            0.1438              0.0060         0.0106        0.0000\n```\n:::\n:::\n\n\n\n### Solution to Question 3\n\n---\n\n<br>  \n<br>  \n<br>  \n\n\n\n\n# Visualizing Categorical Data\n\n---\n\nThere are many different ways we can great visualizations to gain insight into our data and search for possible patterns and relations between different variables.\n\n-   **For one categorical variable:** Bar charts (or bar plots) and pie charts are commonly used.\n-   **For two categorical variables:** Grouped and stacked bar charts are commonly used.\n\n## Creating Bar Charts with `plot()`\n\n---\n\n- The `plot()` function is the most broadly used function for plotting different data types.\n- The type of plot generated by `plot()` depends on the data type(s) and the number of variable(s) we input.\n  - If we input one categorical variable that is stored as `factor`, we get a bar chart.\n  - If we input one quantitative variable, the plot is typically not very useful.\n  - If a categorical variable is stored incorrectly as quantitative, we do not get an appropriate plot.\n- If we use `plot()` to display a categorical variable, the variable must be stored as a factor!\n  - Recall we converted `category` to a `factor` in a previous code cell.\n  - The variable `month` is a quantitative variable.\n\n  \n\n::: {.cell}\n\n```{.r .cell-code}\n# plots appear in an array with 1 row and 2 columns\npar(mfrow = c(1, 2))  # create an array of plots\n\nplot(storms$category,  # categorical data\n     main = \"Hurricanes by Category\",  # main title\n     xlab = \"Hurricane Category\",  # horizontal axis label\n     ylab = \"Frequency\",  # vertical axis label\n     col = \"steelblue\")  # fill color of bars)\n\nplot(storms$month,  # quantitative data\n     main = \"Not Number of Storms in Month\",  # main title\n     xlab = \"Index (Row of Observation)\",  # horizontal axis label\n     ylab = \"Month\")  # vertical axis label\n```\n\n::: {.cell-output-display}\n![](02-EDA-Categorical_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n## Creating Bar Charts and Pie Charts from a Table\n\n---\n\nIf we want to keep `month` stored as an integer, but would like to create a visualization to display the number of storms that occurred in each month, we can: \n\n1. First use the `table()` function to count how many storms occurred in each month.\n2. Then create a bar chart using the `barplot()` function or pie chart using `pie()`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# plots appear in an array with 1 row and 2 columns\npar(mfrow = c(1, 2))  # create an array of plots\n\nmonth.table <- table(storms$month)  # create table of month counts\ncategory.table <- table(storms$category)  # create table of category counts\n\nbarplot(month.table,  # input table of month counts\n        main = \"Storms in Each Month\",  # main title\n        xlab = \"Month\",  # horizontal axis label\n        ylab = \"Frequency\",  # vertical axis label\n        col = \"seagreen\")  # fill color of bars\n\npie(category.table,  # input table of category counts\n    main = \"Hurricanes by Category\")  # main title\n```\n\n::: {.cell-output-display}\n![](02-EDA-Categorical_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\nNote, `pie()` and `barplot()` both take tables as inputs. Even if a variable is stored as a `factor`, we need to store the counts in a table first.\n\n- The `category` variable in `storms` is stored as a factor, but the code below still crashes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# see what happens if input is not a table\npie(storms$category)\n```\n:::\n\n\n\n# Relationship Between Two Categorical Variables\n\n---\n\n\nImagine we would like to compare the number of different category hurricanes that occurred in each month. In this case, we would like to compare two qualitative variables, namely `category` and `month`.\n\n\n## Grouped Frequency Bar Charts\n\n---\n\nTo create a bar chart displaying the number of category hurricanes that occurred in each month:\n\n1. First create a two-way table of counts. \n    - The second variable (`month`) is displayed on horizontal axis.\n    - We get a separate bar for each level of the first variable (`category`).\n2. Input the table into the `barplot()` function.\n    - Note the option `beside = TRUE` groups the bars for each month.\n    - The default option `beside = FALSE` stacks the bars.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# two-way table of counts of category in each month\ncat.table <- table(storms$category, storms$month)  # gives counts\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# create a vector of colors\nmy.colors <- c(\"green\", \"purple\", \"grey\", \"red\", \"blue\") \n\n# create side by side bar chart\nbarplot(cat.table,  # use counts from contingency table\n        beside = TRUE,  # groups side-by-side\n        main = \"Category Hurricanes By Month\",  # main title\n        xlab = \"Month\",  # horizontal axis label\n        col = my.colors,  # fill color of bars\n        ylab = \"Frequency\")  # vertical axis label\n\n# add a legend to plot\nlegend(x=\"topleft\",  # place legend in top left\n       legend=rownames(cat.table),  # get labels from row name in contingency table\n       fill = my.colors)  # use same fill colors\n```\n\n::: {.cell-output-display}\n![](02-EDA-Categorical_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n## Stacked Relative Frequency Bar Charts\n\n---\n\nTo create a bar chart displaying the relative frequency (or proportion) of category hurricanes that occurred in each month:\n\n1. First create a two-way table of relative frequencies.\n    - Pay attention to whether you want the proportions relative to grand, row, or column totals.\n2. Input the table into the `barplot()` function.\n    - The default option `beside = FALSE` stacks the bars.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat.grand <- prop.table(cat.table)  # gives proportions relative to grand total\ncat.row <- prop.table(cat.table, 1)  # gives proportions relative to row totals\ncat.col <- prop.table(cat.table, 2)  # gives proportions relative to column totals\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1, 3))  # create an array of plots\n\n# create stacked bar chart 1\nbarplot(cat.grand,  # use proportions from contingency table\n        main = \"Category Hurricanes By Month\",  # main title\n        xlab = \"Month\",  # horizontal axis label\n        col = my.colors,  # color of bars\n        ylab = \"Proportion\")  # vertical axis label\n\n# add legend to plot\nlegend(x=\"topleft\",  # place legend in top left\n       legend=rownames(cat.grand),  # get labels\n       fill = my.colors)  # use same colors\n\n##########\n\n# create stacked bar chart 2\nbarplot(cat.row,  # use proportions from contingency table\n        main = \"Category Hurricanes By Month\",  # main title\n        xlab = \"Month\",  # horizontal axis label\n        col = my.colors,  # color of bars\n        ylab = \"Proportion\")  # vertical axis label\n\n# add legend to plot\nlegend(x=\"topleft\",  # place legend in top left\n       legend=rownames(cat.row),  # get labels\n       fill = my.colors)  # use same colors\n\n###########\n\n# create stacked bar chart 3\nbarplot(cat.col,  # use proportions from contingency table\n        main = \"Category Hurricanes By Month\",  # main title\n        xlab = \"Month\",  # horizontal axis label\n        col = my.colors,  # color of bars\n        ylab = \"Proportion\")  # vertical axis label\n\n# add legend to plot\nlegend(x=\"topleft\",  # place legend in top left\n       legend=rownames(cat.col),  # get labels\n       fill = my.colors)  # use same colors\n```\n\n::: {.cell-output-display}\n![](02-EDA-Categorical_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n::: {.callout-note}\nA proportion greater than 1 in the middle bar chart means, for example, the sum of the all September proportions (one relative to each category total) adds up to $2.8$ since in 4 out of the 5 possible hurricane categories September accounts for over half the total. \n:::\n\n## Question 4\n\n---\n\nBased on the three plots generated in the previous code cell, answer the questions below.\n\na. Which month has the most hurricanes?\n\nb. In which month is the proportion of category 1 hurricanes greatest?\n\n### Solution to Question 4\n\n---\n\n<br>  \n<br>  \n<br>  \n\n\n\n## Question 5\n\n---\n\nWhat are the the differences in the three plots in the output of the previous code cell? Which of the three bar plots above do you believe best visualizes the occurrence of different category hurricanes by month? Which plot do you think is the least useful overall? Explain why. \n\n\n### Solution to Question 5\n\n---\n\n<br>  \n<br>  \n<br>  \n\n\n\n# Exploring the General Social Survey Data Set\n\n---\n\n\nThe data set `gss_cat` can be accessed from the `forcats` package. Below is a quote taken from the website of the [GSS Data Explorer website](https://gssdataexplorer.norc.org/about){target=\"_blank\"} maintained by NORC at the University of Chicago\n\n>The General Social Survey (GSS) is a project of NORC at the University of Chicago, with principal funding from the National Science Foundation. Since 1972, the GSS has been monitoring societal change and studying the growing complexity of American society.\n\n>The GSS is a publicly available national resource, and is one of the most frequently analyzed sources of information in the social sciences. GSS Data Explorer is one of many ways that NORC supports the dissemination of GSS data for use by legislators, policymakers, researchers, educators and others.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load the forcats package\nlibrary(forcats)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# open help documentation for gss_cat\n?gss_cat\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# get numerical summary of variables\nsummary(gss_cat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      year               marital           age                    race      \n Min.   :2000   No answer    :   17   Min.   :18.00   Other         : 1959  \n 1st Qu.:2002   Never married: 5416   1st Qu.:33.00   Black         : 3129  \n Median :2006   Separated    :  743   Median :46.00   White         :16395  \n Mean   :2007   Divorced     : 3383   Mean   :47.18   Not applicable:    0  \n 3rd Qu.:2010   Widowed      : 1807   3rd Qu.:59.00                         \n Max.   :2014   Married      :10117   Max.   :89.00                         \n                                      NA's   :76                            \n           rincome                   partyid            relig      \n $25000 or more:7363   Independent       :4119   Protestant:10846  \n Not applicable:7043   Not str democrat  :3690   Catholic  : 5124  \n $20000 - 24999:1283   Strong democrat   :3490   None      : 3523  \n $10000 - 14999:1168   Not str republican:3032   Christian :  689  \n $15000 - 19999:1048   Ind,near dem      :2499   Jewish    :  388  \n Refused       : 975   Strong republican :2314   Other     :  224  \n (Other)       :2603   (Other)           :2339   (Other)   :  689  \n              denom          tvhours      \n Not applicable  :10072   Min.   : 0.000  \n Other           : 2534   1st Qu.: 1.000  \n No denomination : 1683   Median : 2.000  \n Southern baptist: 1536   Mean   : 2.981  \n Baptist-dk which: 1457   3rd Qu.: 4.000  \n United methodist: 1067   Max.   :24.000  \n (Other)         : 3134   NA's   :10146   \n```\n:::\n:::\n\n\n\n## Question 6\n\n---\n\nCreate a plot to visualize one categorical variable in the `gss_cat` data set. Based on your plot, comment on any interesting features of the variable you plotted.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create a visualization for one categorical variable\n```\n:::\n\n\n### Solution to Question 6\n\n---\n\n<br>  \n<br>  \n<br>  \n\n\n\n## Question 7\n\n---\n\nCreate a plot to visualize the relationship between two categorical variables in the `gss_cat` data set. Based on your plot, comment on any interesting features or relations between two the variables you plotted.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create a visualization to illustrate the relation\n# between two categorical variables\n```\n:::\n\n\n### Solution to Question 7\n\n---\n\n<br>  \n<br>  \n<br>  \n\n\n\n\n---\n\n![Creative Commons License](https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png) <nbsp>\n\n*Statistical Methods: Exploring the Uncertain* by [Adam Spiegler](https://github.com/CU-Denver-MathStats-OER/Statistical-Theory) is licensed under a [Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License](http://creativecommons.org/licenses/by-nc-sa/4.0/).\n\n\n",
    "supporting": [
      "02-EDA-Categorical_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}